/*! CSSBelt.js - http://easelinc.github.io/cssbelt, built 05-02-2015 */
(function(){var a,b,c,d,e,f,g,h,i,j,k,l,m,n,o,p,q,r,s,t,u,v,w,x,y,z,A,B,C,D,E,F,G,H,I,J={}.hasOwnProperty,K=function(a,b){function c(){this.constructor=a}for(var d in b)J.call(b,d)&&(a[d]=b[d]);return c.prototype=b.prototype,a.prototype=new c,a.__super__=b.prototype,a},L=function(a,b){return function(){return a.apply(b,arguments)}};c={},"undefined"!=typeof module?module.exports=c:window.Curve=c,p=window.SVG||require("./vendor/svg").SVG,p.Circle=function(a){function b(){b.__super__.constructor.call(this,p.create("circle"))}return K(b,a),b.prototype.cx=function(a){return null===a?this.attr("cx"):this.attr("cx",new p.Number(a).divide(this.trans.scaleX))},b.prototype.cy=function(a){return null===a?this.attr("cy"):this.attr("cy",new p.Number(a).divide(this.trans.scaleY))},b.prototype.radius=function(a){return this.attr({r:new p.Number(a)})},b}(p.Shape),p.extend(p.Container,{circle:function(a){return this.put(new p.Circle).radius(a).move(0,0)}}),u=/translate\(([-0-9]+) ([-0-9]+)\)/,p.extend(p.Element,{draggable:function(){var a,b,c,d;return b=this,"function"==typeof this.fixed&&this.fixed(),d=function(d){return E(b,d),v(a,c)},a=function(a){return C(b,a)},c=function(d){return D(b,d),x(a,c)},b.on("mousedown",d),b.fixed=function(){return b.off("mousedown",d),x(),d=a=c=null,b},this}}),v=function(a,b){return p.on(window,"mousemove",a),p.on(window,"mouseup",b)},x=function(a,b){return p.off(window,"mousemove",a),p.off(window,"mouseup",b)},E=function(a,b){var c,d,e,f,g,h;return null==b&&(b=window.event),c=a.parent._parent(p.Nested)||a._parent(p.Doc),a.startEvent=b,f=g=0,e=u.exec(a.attr("transform")),null!=e&&(f=parseInt(e[1]),g=parseInt(e[2])),h=c.viewbox().zoom,d=a.transform("rotation")*Math.PI/180,a.startPosition={x:f,y:g,zoom:h,rotation:d},"function"==typeof a.dragstart&&a.dragstart({x:0,y:0,zoom:h},b),b.preventDefault?b.preventDefault():b.returnValue=!1},C=function(a,b){var c,d,e,f;return null==b&&(b=window.event),a.startEvent?(d=a.startPosition.rotation,c={x:b.pageX-a.startEvent.pageX,y:b.pageY-a.startEvent.pageY,zoom:a.startPosition.zoom},e=a.startPosition.x+(c.x*Math.cos(d)+c.y*Math.sin(d))/a.startPosition.zoom,f=a.startPosition.y+(c.y*Math.cos(d)+c.x*Math.sin(-d))/a.startPosition.zoom,a.transform({x:e,y:f}),"function"==typeof a.dragmove?a.dragmove(c,b):void 0):void 0},D=function(a,b){var c;return null==b&&(b=window.event),c={x:b.pageX-a.startEvent.pageX,y:b.pageY-a.startEvent.pageY,zoom:a.startPosition.zoom},a.startEvent=null,a.startPosition=null,"function"==typeof a.dragend?a.dragend(c,b):void 0},p=window.SVG||require("./vendor/svg").SVG,p.extend(p.Element,{"export":function(a,b){var c,d,e,f,g,h,i,j,k,l,m,n;if(f=this.node.nodeName,g="",e="svg"===f&&!b,a=a||{},!a.exclude||!a.exclude.call(this)){if(a=a||{},b=b||0,e&&(g+=this._whitespaced('<?xml version="1.0" encoding="UTF-8"?>',a.whitespace,b),h=this.attr("width"),c=this.attr("height"),a.width&&this.attr("width",a.width),a.height&&this.attr("height",a.height)),g+=this._whitespaced("<"+f+this.attrToString()+">",a.whitespace,b),e&&(this.attr({width:h,height:c}),g+=this._whitespaced("<desc>Created with Curve</desc>",a.whitespace,b+1),this._defs)){for(g+=this._whitespaced("<defs>",a.whitespace,b+1),d=i=0,l=this._defs.children().length;l>=0?l>i:i>l;d=l>=0?++i:--i)g+=this._defs.children()[d]["export"](a,b+2);g+=this._whitespaced("</defs>",a.whitespace,b+1)}if(this instanceof p.Container)for(d=j=0,m=this.children().length;m>=0?m>j:j>m;d=m>=0?++j:--j)g+=this.children()[d]["export"](a,b+1);else if(this instanceof p.Text)for(d=k=0,n=this.lines.length;n>=0?n>k:k>n;d=n>=0?++k:--k)g+=this.lines[d]["export"](a,b+1);this instanceof p.TSpan&&(g+=this._whitespaced(this.node.firstChild.nodeValue,a.whitespace,b+1)),g+=this._whitespaced("</"+f+">",a.whitespace,b)}return g},exportAttr:function(a){return 0===arguments.length?this.data("svg-export-attr"):this.data("svg-export-attr",a)},attrToString:function(){var a,b,c,d,e,f;if(a=[],b=this.exportAttr(),c=this.attr(),"object"==typeof b)for(e in b)"data-svg-export-attr"!==e&&(c[e]=b[e]);for(e in c)f=c[e],"xlink"===e&&(e="xmlns:xlink"),d="id"===e&&f.indexOf("Svgjs")>-1,!d&&"data-svg-export-attr"!==e&&("stroke"!==e||parseFloat(c["stroke-width"])>0)&&a.push(e+'="'+f+'"');return a.length?" "+a.join(" "):""},_whitespaced:function(a,b,c){var d,e,f,g,h;if(b){if(f="",e=b===!0?"  ":b||"",c)for(d=g=h=c-1;0>=h?0>=g:g>=0;d=0>=h?++g:--g)f+=e;a=f+a+"\n"}return a}}),c["import"]=function(a,b){var d,e,f,g;return d={path:function(b){return[new c.Path(a,{svgEl:b})]},rect:function(b){return[new c.Rectangle(a,{svgEl:b})]}},f=document.createElement("div"),g={},f.innerHTML=b.replace(/\n/,"").replace(/<(\w+)([^<]+?)\/>/g,"<$1$2></$1>"),e=[],w(f.childNodes,a,0,g,function(){var a;return a=this.node.nodeName,d[a]&&(e=e.concat(d[a](this))),null}),f=null,window.objs=e,console.log(window.objs),e},w=function(a,b,c,d,e){var f,g,h,i,j,k,l,m,n,o,p,q,r,s;for(k=o=0,q=a.length;q>=0?q>o:o>q;k=q>=0?++o:--o){switch(g=a[k],f={},h=[],n=g.nodeName.toLowerCase(),f=A(g),n){case"path":i=b[n]();break;case"polygon":i=b[n]();break;case"polyline":i=b[n]();break;case"rect":i=b[n](0,0);break;case"circle":i=b[n](0,0);break;case"ellipse":i=b[n](0,0);break;case"line":i=b.line(0,0,0,0);break;case"text":if(0===g.childNodes.length)i=b[n](g.textContent);else for(i=null,l=p=0,r=g.childNodes.length;r>=0?r>p:p>r;l=r>=0?++p:--p)j=g.childNodes[l],"tspan"===j.nodeName.toLowerCase()&&(null===i?i=b[n](j.textContent):i.tspan(j.textContent).attr(A(j)));break;case"image":i=b.image(f["xlink:href"]);break;case"g":case"svg":i=b["g"===n?"group":"nested"](),w(g.childNodes,i,c+1,d,e);break;case"defs":w(g.childNodes,b.defs(),c+1,d,e);break;case"use":i=b.use();break;case"clippath":case"mask":i=b[null!=(s="mask"===n)?s:{mask:"clip"}](),w(g.childNodes,i,c+1,d,e);break;case"lineargradient":case"radialgradient":i=b.defs().gradient(n.split("gradient")[0],function(a){var b,c,d;for(d=[],l=b=0,c=g.childNodes.length;c>=0?c>b:b>c;l=c>=0?++b:--b)d.push(a.at(A(g.childNodes[l])).style(g.childNodes[l].getAttribute("style")));return d});break;case"#comment":case"#text":case"metadata":case"desc":break;default:console.log("SVG Import got unexpected type "+n,g)}i&&(m=B(f.transform),delete f.transform,i.attr(f).transform(m),i.attr("id")&&(d[i.attr("id")]=i),"text"===n&&i.rebuild(),"function"==typeof e&&e.call(i))}return b},A=function(a){var b,c,d,e,f;if(c=a.attributes||[],b={},c.length)for(d=e=f=c.length-1;0>=f?0>=e:e>=0;d=0>=f?++e:--e)b[c[d].nodeName]=c[d].nodeValue;return b},B=function(a){var b,c,d,e,f,g,h,i;if(f={},d=(a||"").match(/[A-Za-z]+\([^\)]+\)/g)||[],b=p.defaults.trans(),d.length)for(c=h=i=d.length-1;0>=i?0>=h:h>=0;c=0>=i?++h:--h)switch(e=d[c].match(/([A-Za-z]+)\(([^\)]+)\)/),g=(e[2]||"").replace(/^\s+/,"").replace(/,/g," ").replace(/\s+/g," ").split(" "),e[1]){case"matrix":f.a=parseFloat(g[0])||b.a,f.b=parseFloat(g[1])||b.b,f.c=parseFloat(g[2])||b.c,f.d=parseFloat(g[3])||b.d,f.e=parseFloat(g[4])||b.e,f.f=parseFloat(g[5])||b.f;break;case"rotate":f.rotation=parseFloat(g[0])||b.rotation,f.cx=parseFloat(g[1])||b.cx,f.cy=parseFloat(g[2])||b.cy;break;case"scale":f.scaleX=parseFloat(g[0])||b.scaleX,f.scaleY=parseFloat(g[1])||b.scaleY;break;case"skewX":f.skewX=parseFloat(g[0])||b.skewX;break;case"skewY":f.skewY=parseFloat(g[0])||b.skewY;break;case"translate":f.x=parseFloat(g[0])||b.x,f.y=parseFloat(g[1])||b.y}return f},H=window._||require("underscore"),a=window.jQuery||require("jquery"),i=function(){function b(a,b){this.svgToolParent=a,this.pathEditor=b,this.onDraggingHandleOut=L(this.onDraggingHandleOut,this),this.onDraggingHandleIn=L(this.onDraggingHandleIn,this),this.onDraggingNode=L(this.onDraggingNode,this),this.render=L(this.render,this),this.svgDocument=this.svgToolParent.parent,this._setupNodeElement(),this._setupLineElement(),this._setupHandleElements(),this.hide()}var d,e,f,g;return b.prototype.nodeSize=5,b.prototype.handleSize=3,f=null,g=null,d=null,e=null,b.prototype.hide=function(){return this.visible=!1,this.lineElement.hide(),this.nodeElement.hide(),this.handleElements.hide()},b.prototype.show=function(a){return this.visible=!0,this.nodeElement.show(),a&&(this.lineElement.front(),this.nodeElement.front(),this.handleElements.front()),this.enableHandles?(this.lineElement.show(),this.handleElements.show()):(this.lineElement.hide(),this.handleElements.hide())},b.prototype.setEnableHandles=function(a){return this.enableHandles=a,this.visible?this.show():void 0},b.prototype.setNode=function(a){return this._unbindNode(this.node),this.node=a,this._bindNode(this.node),this.setEnableHandles(!1),this.render()},b.prototype.render=function(){var a,b,c,d;return this.node?(a=this.node.getAbsoluteHandleIn(),b=this.node.getAbsoluteHandleOut(),d=this.node.getPoint(),c="M"+a.x+","+a.y+"L"+d.x+","+d.y+"L"+b.x+","+b.y,this.lineElement.attr({d:c}),this.handleElements.members[0].attr({cx:a.x,cy:a.y,transform:""}),this.handleElements.members[1].attr({cx:b.x,cy:b.y,transform:""}),this.nodeElement.attr({cx:d.x,cy:d.y,transform:""}),this.show(),this._draggingHandle?this._draggingHandle.front():void 0):this.hide()},b.prototype.onDraggingNode=function(a,b){return this.node.setPoint(this.pointForEvent(b))},b.prototype.onDraggingHandleIn=function(a,b){return this.node.setAbsoluteHandleIn(this.pointForEvent(b))},b.prototype.onDraggingHandleOut=function(a,b){return this.node.setAbsoluteHandleOut(this.pointForEvent(b))},b.prototype.pointForEvent=function(b){var d,e,f,g,h;return d=b.clientX,e=b.clientY,h=a(this.svgDocument.node).offset(),g=h.top,f=h.left,new c.Point(b.clientX-f,b.clientY-g)},b.prototype._bindNode=function(a){var b;if(a)return a.addListener("change",this.render),null!=(b=a.getPath())?b.addListener("change",this.render):void 0},b.prototype._unbindNode=function(a){var b;if(a)return a.removeListener("change",this.render),null!=(b=a.getPath())?b.addListener("change",this.render):void 0},b.prototype._setupNodeElement=function(){var a=this;return this.nodeElement=this.svgToolParent.circle(this.nodeSize),this.nodeElement.node.setAttribute("class","node-editor-node"),this.nodeElement.click(function(b){return b.stopPropagation(),a.setEnableHandles(!0),a.pathEditor.activateNode(a.node),!1}),this.nodeElement.draggable(),this.nodeElement.dragstart=function(){return a.pathEditor.activateNode(a.node)},this.nodeElement.dragmove=this.onDraggingNode,this.nodeElement.on("mouseover",function(){return a.nodeElement.front(),a.nodeElement.attr({r:a.nodeSize+2})}),this.nodeElement.on("mouseout",function(){return a.nodeElement.attr({r:a.nodeSize})})},b.prototype._setupLineElement=function(){return this.lineElement=this.svgToolParent.path(""),this.lineElement.node.setAttribute("class","node-editor-lines")},b.prototype._setupHandleElements=function(){var a,b,c;return c=this,this.handleElements=this.svgToolParent.set(),this.handleElements.add(this.svgToolParent.circle(this.handleSize),this.svgToolParent.circle(this.handleSize)),this.handleElements.members[0].node.setAttribute("class","node-editor-handle"),this.handleElements.members[1].node.setAttribute("class","node-editor-handle"),this.handleElements.click(function(a){return a.stopPropagation(),!1}),a=function(){return c._draggingHandle=this},b=function(){return c._draggingHandle=null},this.handleElements.members[0].draggable(),this.handleElements.members[0].dragmove=this.onDraggingHandleIn,this.handleElements.members[0].dragstart=a,this.handleElements.members[0].dragend=b,this.handleElements.members[1].draggable(),this.handleElements.members[1].dragmove=this.onDraggingHandleOut,this.handleElements.members[1].dragstart=a,this.handleElements.members[1].dragend=b,this.handleElements.on("mouseover",function(){return this.front(),this.attr({r:c.handleSize+2})}),this.handleElements.on("mouseout",function(){return this.attr({r:c.handleSize})})},b}(),c.NodeEditor=i,H=window._||require("underscore"),e=window.EventEmitter||require("events").EventEmitter,h=function(a){function b(a,b,c,d){this.isJoined=null!=d?d:!1,this.setPoint(a),b&&this.setHandleIn(b),c&&this.setHandleOut(c)}return K(b,a),b.prototype.join=function(a){return null==a&&(a="handleIn"),this.isJoined=!0,this["set"+a.replace("h","H")](this[a])},b.prototype.setPath=function(a){this.path=a},b.prototype.getPath=function(){return this.path},b.prototype.getPoint=function(){return this._transformPoint(this.point)},b.prototype.getHandleIn=function(){return this.handleIn},b.prototype.getHandleOut=function(){return this.handleOut},b.prototype.getAbsoluteHandleIn=function(){return this.handleIn?this._transformPoint(this.point.add(this.handleIn)):this.getPoint()},b.prototype.getAbsoluteHandleOut=function(){return this.handleOut?this._transformPoint(this.point.add(this.handleOut)):this.getPoint()},b.prototype.setAbsoluteHandleIn=function(a){return this.setHandleIn(m.create(a).subtract(this.point))},b.prototype.setAbsoluteHandleOut=function(a){return this.setHandleOut(m.create(a).subtract(this.point))},b.prototype.setPoint=function(a){return this.set("point",m.create(a))},b.prototype.setHandleIn=function(a){return a&&(a=m.create(a)),this.set("handleIn",a),this.isJoined?this.set("handleOut",a?new c.Point(0,0).subtract(a):a):void 0},b.prototype.setHandleOut=function(a){return a&&(a=m.create(a)),this.set("handleOut",a),this.isJoined?this.set("handleIn",a?new c.Point(0,0).subtract(a):a):void 0},b.prototype.computeIsjoined=function(){return this.isJoined=!this.handleIn&&!this.handleOut||this.handleIn&&this.handleOut&&Math.round(this.handleIn.x)===Math.round(-this.handleOut.x)&&Math.round(this.handleIn.y)===Math.round(-this.handleOut.y)},b.prototype.set=function(a,b){var c,d,e;return e=this[a],this[a]=b,c="change:"+a,d={event:c,value:b,old:e},this.emit(c,this,d),this.emit("change",this,d)},b.prototype.translate=function(a){return a=m.create(a),this.set("point",this.point.add(a))},b.prototype._transformPoint=function(a){var b,c;return b=null!=(c=this.path)?c.getTransform():void 0,null!=b&&(a=b.transformPoint(a)),a},b}(e),c.Node=h,j=function(){function a(a,b){this.svgDocument=a,this.selectionModel=b,this.onChangeSelected=L(this.onChangeSelected,this),this.active=!1,this.activeEditor=null,this.editors={Path:new PathEditor(this.svgDocument)}}return a.prototype.activate=function(){return this.active=!0,this.selectionModel.on("change:selected",this.onChangeSelected)},a.prototype.deactivate=function(){return this.selectionModel.removeListener("change:selected",this.onChangeSelected),this.active=!1},a.prototype.isActive=function(){return this.active},a.prototype.getActiveObject=function(){var a;return null!=(a=this.activeEditor)?a.getActiveObject():void 0},a.prototype.onChangeSelected=function(a){var b,c,d,e;return b=a.object,c=a.old,null!=(d=this.activeEditor)&&d.deactivate(),this.activeEditor=this.editors[b.getType()],null!=(e=this.activeEditor)?e.activateObject(b):void 0},a}(),e=window.EventEmitter||require("events").EventEmitter,c.ObjectSelection=function(a){function b(a,b){var c;this.svgDocument=a,this.options=null!=b?b:{},this.render=L(this.render,this),null==(c=this.options)["class"]&&(c["class"]="object-selection")}return K(b,a),b.prototype.setObject=function(a){var b;return this._unbindObject(this.object),b=a,this.object=a,this._bindObject(this.object),this.trackingObject&&this.trackingObject.remove(),this.trackingObject=null,this.object&&(this.trackingObject=this.object.cloneElement(this.svgDocument).back(),this.trackingObject.node.setAttribute("class",this.options["class"]+" invisible-to-hit-test"),this.render()),this.emit("change:object",{objectSelection:this,object:this.object,old:b})},b.prototype.render=function(){return this.object.render(this.trackingObject)},b.prototype._bindObject=function(a){return a?a.on("change",this.render):void 0},b.prototype._unbindObject=function(a){return a?a.removeListener("change",this.render):void 0},b}(e),c.PathEditor=function(){function a(a){this.svgDocument=a,this.onInsertNode=L(this.onInsertNode,this),this.path=null,this.node=null,this.nodeEditors=[],this._nodeEditorPool=[]}return a.prototype.nodeSize=5,a.prototype.getActiveObject=function(){return this.path},a.prototype.isActive=function(){return!!this.path},a.prototype.activateObject=function(a){return this.deactivate(),null!=a?(this.path=a,this._bindToObject(this.path),this._createNodeEditors(this.path)):void 0},a.prototype.deactivate=function(){return this.deactivateNode(),null!=this.path&&this._unbindFromObject(this.path),this._removeNodeEditors(),this.path=null},a.prototype.activateNode=function(a){var b;return this.deactivateNode(),null!=a&&(this.selectedNode=a,b=this._findNodeEditorForNode(a),null!=b)?b.setEnableHandles(!0):void 0},a.prototype.deactivateNode=function(){var a;return null!=this.selectedNode&&(a=this._findNodeEditorForNode(this.selectedNode),null!=a&&a.setEnableHandles(!1)),this.selectedNode=null},a.prototype.onInsertNode=function(a,b){var c,d,e;return e=null!=b?b:{},d=e.node,c=e.index,this._addNodeEditor(d),null},a.prototype._bindToObject=function(a){return a?a.on("insert:node",this.onInsertNode):void 0},a.prototype._unbindFromObject=function(a){return a?a.removeListener("insert:node",this.onInsertNode):void 0},a.prototype._removeNodeEditors=function(){var a,b,c,d;for(this._nodeEditorPool=this._nodeEditorPool.concat(this.nodeEditors),this.nodeEditors=[],d=this._nodeEditorPool,b=0,c=d.length;c>b;b++)a=d[b],a.setNode(null)},a.prototype._createNodeEditors=function(a){var b,c,d,e;if(this._removeNodeEditors(),null!=(null!=a?a.getNodes:void 0))for(c=a.getNodes(),d=0,e=c.length;e>d;d++)b=c[d],this._addNodeEditor(b)},a.prototype._addNodeEditor=function(a){var b;return a?(b=this._nodeEditorPool.length?this._nodeEditorPool.pop():new c.NodeEditor(this.svgDocument,this),b.setNode(a),this.nodeEditors.push(b),!0):!1},a.prototype._findNodeEditorForNode=function(a){var b,c,d,e;for(e=this.nodeEditors,c=0,d=e.length;d>c;c++)if(b=e[c],b.node===a)return b;return null},a}(),H=window._||require("underscore"),I=["COMMAND","NUMBER"],b=I[0],g=I[1],F=function(a){var b;return b=z(a),G(y(b))},G=function(a){var b,c,d,e,f,g,i,j,k,l,m,n,o,p,q,r,s,t,u,v,w,x,y,z,A,B,C;if(p={subpaths:[]},1===a.length&&("M"===(x=a[0].type)||"m"===x))return p;for(e=null,f=null,b=function(a){var b;return b=new h(a),f={closed:!1,nodes:[b]},p.subpaths.push(f),b},q=function(a,b){return[a[b],a[b+1]]},m=function(a){return H.map(a,function(a,b){return a+e[b%2]})},d=function(b,c){var d,g,i,j;return e=b,i=null,d=f.nodes[0],g=a[c+1],g&&("z"===(j=g.type)||"Z"===j)&&d&&d.point.equals(e)||(i=new h(e),f.nodes.push(i)),i},k=s=0,y=a.length;y>=0?y>s:s>y;k=y>=0?++s:--s)switch(c=a[k],c.type){case"M":e=c.parameters,b(e);break;case"L":case"l":o=c.parameters,"l"===c.type&&(o=m(o)),d(q(o,0),k);break;case"H":case"h":o=c.parameters,"h"===c.type&&(o=m(o)),d([o[0],e[1]],k);break;case"V":case"v":o=c.parameters,"v"===c.type&&(o=m([0,o[0]]),o=o.slice(1)),d([e[0],o[0]],k);break;case"C":case"c":case"Q":case"q":o=c.parameters,("c"===(z=c.type)||"q"===z)&&(o=m(o)),"C"===(A=c.type)||"c"===A?(e=q(o,4),i=q(o,2),j=q(o,0)):(e=q(o,2),i=j=q(o,0)),l=f.nodes[f.nodes.length-1],l.setAbsoluteHandleOut(j),(n=d(e,k))?n.setAbsoluteHandleIn(i):(g=f.nodes[0],g.setAbsoluteHandleIn(i));break;case"S":case"s":o=c.parameters,"s"===c.type&&(o=m(o)),e=q(o,2),i=q(o,0),l=f.nodes[f.nodes.length-1],l.join("handleIn"),(n=d(e,k))?n.setAbsoluteHandleIn(i):(g=f.nodes[0],g.setAbsoluteHandleIn(i));break;case"T":case"t":o=c.parameters,"t"===c.type&&(o=m(o)),e=q(o,0),l=f.nodes[f.nodes.length-1],l.join("handleIn"),i=l.getAbsoluteHandleOut(),(n=d(e,k))?n.setAbsoluteHandleIn(i):(g=f.nodes[0],g.setAbsoluteHandleIn(i));break;case"Z":case"z":f.closed=!0}for(B=p.subpaths,t=0,v=B.length;v>t;t++)for(r=B[t],C=r.nodes,u=0,w=C.length;w>u;u++)n=C[u],n.computeIsjoined();return p},y=function(a){var c,d,e,f,h,i,j;for(d=[],e=i=0,j=a.length;j>=0?j>i:i>j;e=j>=0?++i:--i)if(h=a[e],h.type===b){for(c={type:h.string,parameters:[]};(f=a[e+1])&&f.type===g;)c.parameters.push(parseFloat(f.string)),e++;d.push(c)}return d},z=function(a){var c,d,e,f,h,i,j,k,l;for(e="-0123456789.",i=" ,\n	",j=[],d=null,h=function(a){return d&&d.type!==a?f():void 0},f=function(){return d?(d.string.join&&(d.string=d.string.join("")),j.push(d),d=null):void 0},k=0,l=a.length;l>k;k++)c=a[k],e.indexOf(c)>-1?(h(g),"-"===c&&f(),d||(d={type:g,string:[]}),d.string.push(c)):i.indexOf(c)>-1?f():(f(),j.push({type:b,string:c}));return f(),j},c.PathParser={lexPath:z,parsePath:F,groupCommands:y,parseTokens:G},H=window._||require("underscore"),e=window.EventEmitter||require("events").EventEmitter,d={fill:"#eee",stroke:"none"},f=0,l=function(a){function b(){this.onSubpathChange=L(this.onSubpathChange,this),this.subpaths=[],this.pathString="",this.transform=new c.Transform}return K(b,a),b.prototype.getNodes=function(){var a;return H.flatten(function(){var b,c,d,e;for(d=this.subpaths,e=[],b=0,c=d.length;c>b;b++)a=d[b],e.push(a.getNodes());return e}.call(this),!0)},b.prototype.getTransform=function(){return this.transform},b.prototype.getTransformString=function(){return this.transform.toString()},b.prototype.setTransformString=function(a){return this.transform.setTransformString(a)?this._emitChangeEvent():void 0},b.prototype.getPathString=function(){return this.pathString},b.prototype.setPathString=function(a){return a!==this.pathString?this._parseFromPathString(a):void 0},b.prototype.toString=function(){return this.getPathString()},b.prototype.translate=function(a){var b,c,d,e;for(a=m.create(a),e=this.subpaths,c=0,d=e.length;d>c;c++)b=e[c],b.translate(a)},b.prototype.addNode=function(a){return this._addCurrentSubpathIfNotPresent(),this.currentSubpath.addNode(a)},b.prototype.insertNode=function(a,b){return this._addCurrentSubpathIfNotPresent(),this.currentSubpath.insertNode(a,b)},b.prototype.close=function(){return this._addCurrentSubpathIfNotPresent(),this.currentSubpath.close()},b.prototype._addCurrentSubpathIfNotPresent=function(){return this.currentSubpath?void 0:this.currentSubpath=this._createSubpath()},b.prototype.onSubpathChange=function(a,b){return this._updatePathString(),this._emitChangeEvent()},b.prototype._createSubpath=function(a){return null==a&&(a={}),a.path=this,this._addSubpath(new r(a))},b.prototype._addSubpath=function(a){return this.subpaths.push(a),this._bindSubpath(a),this._updatePathString(),a},b.prototype._bindSubpath=function(a){return a?(a.on("change",this.onSubpathChange),a.on("insert:node",this._forwardEvent.bind(this,"insert:node"))):void 0},b.prototype._unbindSubpath=function(a){return a?a.off():void 0},b.prototype._removeAllSubpaths=function(){var a,b,c,d;for(d=this.subpaths,b=0,c=d.length;c>b;b++)a=d[b],this._unbindSubpath(a);return this.subpaths=[]},b.prototype._updatePathString=function(){var a,b;return a=this.pathString,this.pathString=function(){var a,c,d,e;for(d=this.subpaths,e=[],a=0,c=d.length;c>a;a++)b=d[a],e.push(b.toPathString());return e}.call(this).join(" "),a!==this.pathString?this._emitChangeEvent():void 0},b.prototype._parseFromPathString=function(a){var b,d,e,f,g;if(a&&a!==this.pathString){for(this._removeAllSubpaths(),b=c.PathParser.parsePath(a),g=b.subpaths,e=0,f=g.length;f>e;e++)d=g[e],this._createSubpath(d);return this.currentSubpath=H.last(this.subpaths),this._updatePathString(),null}},b.prototype._forwardEvent=function(a,b,c){return this.emit(a,this,c)},b.prototype._emitChangeEvent=function(){return this.emit("change",this)},b}(e),k=function(a){function b(a,b){var c;this.svgDocument=a,c=(null!=b?b:{}).svgEl,this.onModelChange=L(this.onModelChange,this),this.id=f++,this.model=new l,this.model.on("change",this.onModelChange),this.model.on("insert:node",this._forwardEvent.bind(this,"insert:node")),this._setupSVGObject(c)}return K(b,a),b.prototype.getPath=function(){return"Path"},b.prototype.toString=function(){return"Path "+this.id+" "+this.model.toString()},b.prototype.getPathString=function(){return this.model.getPathString()},b.prototype.getNodes=function(){return this.model.getNodes()},b.prototype.getSubpaths=function(){return this.model.subpaths},b.prototype.addNode=function(a){return this.model.addNode(a)},b.prototype.insertNode=function(a,b){return this.model.insertNode(a,b)},b.prototype.close=function(){return this.model.close()},b.prototype.enableDragging=function(a){var b,c=this;return b=this.svgEl,null!=b?(this.disableDragging(),b.draggable(),b.dragstart=function(b){return null!=a&&"function"==typeof a.dragstart?a.dragstart(b):void 0},b.dragmove=function(b){return c.updateFromAttributes(),null!=a&&"function"==typeof a.dragmove?a.dragmove(b):void 0},b.dragend=function(b){return c.model.setTransformString(null),c.model.translate([b.x,b.y]),null!=a&&"function"==typeof a.dragend?a.dragend(b):void 0}):void 0},b.prototype.disableDragging=function(){var a;return a=this.svgEl,null!=a?("function"==typeof a.fixed&&a.fixed(),a.dragstart=null,a.dragmove=null,a.dragend=null):void 0},b.prototype.updateFromAttributes=function(){var a,b;return a=this.svgEl.attr("d"),b=this.svgEl.attr("transform"),this.model.setTransformString(b),this.model.setPathString(a)},b.prototype.render=function(a){var b;return null==a&&(a=this.svgEl),b=this.model.getPathString(),b&&a.attr({d:b}),a.attr({transform:this.model.getTransformString()||null})},b.prototype.cloneElement=function(a){var b;return null==a&&(a=this.svgDocument),b=a.path(),this.render(b),b},b.prototype.onModelChange=function(){return this.render(),this.emit("change",this)},b.prototype._forwardEvent=function(a,b,c){return c.path=this,this.emit(a,this,c)},b.prototype._setupSVGObject=function(a){return this.svgEl=a,this.svgEl||(this.svgEl=this.svgDocument.path().attr(d)),c.Utils.setObjectOnNode(this.svgEl.node,this),this.model.setPathString(this.svgEl.attr("d"))},b}(e),c.Path=k,c.PenTool=function(){function a(a,b){var c;this.svgDocument=a,c=null!=b?b:{},this.selectionModel=c.selectionModel,this.selectionView=c.selectionView,this.onMouseUp=L(this.onMouseUp,this),this.onMouseMove=L(this.onMouseMove,this),this.onMouseDown=L(this.onMouseDown,this)}return a.prototype.currentObject=null,a.prototype.currentNode=null,a.prototype.activate=function(){return this.svgDocument.on("mousedown",this.onMouseDown),this.svgDocument.on("mousemove",this.onMouseMove),this.svgDocument.on("mouseup",this.onMouseUp)},a.prototype.deactivate=function(){return this.svgDocument.off("mousedown",this.onMouseDown),this.svgDocument.off("mousemove",this.onMouseMove),this.svgDocument.off("mouseup",this.onMouseUp)},a.prototype.onMouseDown=function(a){var b,d=this;return b=function(){return d.currentNode=new c.Node([a.clientX,a.clientY],[0,0],[0,0]),d.currentObject.addNode(d.currentNode),d.selectionModel.setSelectedNode(d.currentNode)},this.currentObject?this.selectionView.nodeEditors.length&&a.target===this.selectionView.nodeEditors[0].nodeElement.node?(this.currentObject.close(),this.currentObject=null):b():(this.currentObject=new c.Path(this.svgDocument),this.selectionModel.setSelected(this.currentObject),b())},a.prototype.onMouseMove=function(a){return this.currentNode?this.currentNode.setAbsoluteHandleOut([a.clientX,a.clientY]):void 0},a.prototype.onMouseUp=function(a){return this.currentNode=null},a}(),H=window._||require("underscore"),m=function(){function a(a,b){this.set(a,b)}return a.create=function(b,c){return b instanceof a?b:Array.isArray(b)?new a(b[0],b[1]):new a(b,c)},a.prototype.set=function(a,b){var c;return this.x=a,this.y=b,H.isArray(this.x)?(c=this.x,this.x=c[0],this.y=c[1],c):void 0},a.prototype.add=function(b){return b=a.create(b),new a(this.x+b.x,this.y+b.y)},a.prototype.subtract=function(b){return b=a.create(b),new a(this.x-b.x,this.y-b.y)},a.prototype.toArray=function(){return[this.x,this.y]},a.prototype.equals=function(b){return b=a.create(b),b.x===this.x&&b.y===this.y},a.prototype.toString=function(){return"("+this.x+", "+this.y+")"},a}(),c.Point=m,a=window.jQuery||require("underscore"),c.PointerTool=function(){function b(a,b){var c;this.svgDocument=a,c=null!=b?b:{},this.selectionModel=c.selectionModel,this.selectionView=c.selectionView,this.onMouseMove=L(this.onMouseMove,this),this.onClick=L(this.onClick,this),this.onChangedSelectedObject=L(this.onChangedSelectedObject,this),this._evrect=this.svgDocument.node.createSVGRect(),this._evrect.width=this._evrect.height=1}return b.prototype.activate=function(){var a;return this.svgDocument.on("click",this.onClick),this.svgDocument.on("mousemove",this.onMouseMove),a=this.selectionView.getObjectSelection(),a.on("change:object",this.onChangedSelectedObject)},b.prototype.deactivate=function(){var a;return this.svgDocument.off("click",this.onClick),this.svgDocument.off("mousemove",this.onMouseMove),a=this.selectionView.getObjectSelection(),a.off("change:object",this.onChangedSelectedObject)},b.prototype.onChangedSelectedObject=function(a){var b,c;return b=a.object,c=a.old,null!=b?b.enableDragging():null!=c?c.disableDragging():void 0},b.prototype.onClick=function(a){var b;return b=this._hitWithTarget(a),this.selectionModel.setSelected(b),b?!1:void 0},b.prototype.onMouseMove=function(a){return this.selectionModel.setPreselected(this._hitWithTarget(a))},b.prototype._hitWithTarget=function(a){var b;return b=null,a.target!==this.svgDocument.node&&(b=c.Utils.getObjectFromNode(a.target)),b},b.prototype._hitWithIntersectionList=function(b){var d,e,f,g,h,i,j,k,l;if(k=a(this.svgDocument.node).offset(),f=k.left,i=k.top,this._evrect.x=b.clientX-f,this._evrect.y=b.clientY-i,g=this.svgDocument.node.getIntersectionList(this._evrect,null),h=null,g.length)for(e=j=l=g.length-1;0>=l?0>=j:j>=0;e=0>=l?++j:--j)if(d=g[e].getAttribute("class"),!(d&&d.indexOf("invisible-to-hit-test")>-1)){h=c.Utils.getObjectFromNode(g[e]);break}return console.log(h),h},b}(),H=window._||require("underscore"),e=window.EventEmitter||require("events").EventEmitter,d={x:0,y:0,width:10,height:10,fill:"#eee",stroke:"none"},f=0,o=function(a){function b(){this.id=f++,this.transform=new c.Transform}return K(b,a),b.prototype.position=null,b.prototype.size=null,b.prototype.transform=null,b.prototype.getTransform=function(){return this.transform},b.prototype.getTransformString=function(){return this.transform.toString()},b.prototype.setTransformString=function(a){return this.transform.setTransformString(a)?this._emitChangeEvent():void 0},b.prototype.getPosition=function(){return this.position},b.prototype.setPosition=function(a,b){return this.position=m.create(a,b),this._emitChangeEvent()},b.prototype.getSize=function(){return this.size},b.prototype.setSize=function(a,b){return this.size=q.create(a,b),this._emitChangeEvent()},b.prototype.toString=function(){return"{Rect "+this.id+": "+this.position+" "+this.size},b.prototype.translate=function(a){return a=m.create(a),this.setPosition(this.position.add(a)),this._emitChangeEvent()},b.prototype._emitChangeEvent=function(){return this.emit("change",this)},b}(e),n=function(a){function b(a,b){var c;this.svgDocument=a,c=(null!=b?b:{}).svgEl,this.onModelChange=L(this.onModelChange,this),this.model=new o,this._setupSVGObject(c),this.model.on("change",this.onModelChange)}return K(b,a),b.prototype.getType=function(){return"Rectangle"},b.prototype.toString=function(){return this.model.toString()},b.prototype.enableDragging=function(a){var b,c=this;return b=this.svgEl,null!=b?(this.disableDragging(),b.draggable(),b.dragstart=function(b){return null!=a&&"function"==typeof a.dragstart?a.dragstart(b):void 0},b.dragmove=function(b){return c.updateFromAttributes(),null!=a&&"function"==typeof a.dragmove?a.dragmove(b):void 0},b.dragend=function(b){return c.model.setTransformString(null),c.model.translate([b.x,b.y]),null!=a&&"function"==typeof a.dragend?a.dragend(b):void 0}):void 0},b.prototype.disableDragging=function(){var a;return a=this.svgEl,null!=a?("function"==typeof a.fixed&&a.fixed(),a.dragstart=null,a.dragmove=null,a.dragend=null):void 0},b.prototype.updateFromAttributes=function(){var a,b,c,d,e;return d=this.svgEl.attr("x"),e=this.svgEl.attr("y"),c=this.svgEl.attr("width"),a=this.svgEl.attr("height"),b=this.svgEl.attr("transform"),this.model.setPosition(d,e),this.model.setSize(c,a),this.model.setTransformString(b)},b.prototype.render=function(a){
var b,c;return null==a&&(a=this.svgEl),b=this.model.getPosition(),c=this.model.getSize(),a.attr({x:b.x}),a.attr({y:b.y}),a.attr({width:c.width}),a.attr({height:c.height}),a.attr({transform:this.model.getTransformString()||null})},b.prototype.cloneElement=function(a){var b;return null==a&&(a=this.svgDocument),b=a.rect(),this.render(b),b},b.prototype.onModelChange=function(){return this.render(),this.emit("change",this)},b.prototype._setupSVGObject=function(a){return this.svgEl=a,this.svgEl||(this.svgEl=this.svgDocument.rect().attr(d)),c.Utils.setObjectOnNode(this.svgEl.node,this),this.updateFromAttributes()},b}(e),c.Rectangle=n,e=window.EventEmitter||require("events").EventEmitter,c.SelectionModel=function(a){function b(){this.preselected=null,this.selected=null,this.selectedNode=null}return K(b,a),b.prototype.setPreselected=function(a){var b;if(a!==this.preselected&&(!a||a!==this.selected))return b=this.preselected,this.preselected=a,this.emit("change:preselected",{object:this.preselected,old:b})},b.prototype.setSelected=function(a){var b;if(a!==this.selected)return b=this.selected,this.selected=a,this.preselected===a&&this.setPreselected(null),this.emit("change:selected",{object:this.selected,old:b})},b.prototype.setSelectedNode=function(a){var b;if(a!==this.selectedNode)return b=this.selectedNode,this.selectedNode=a,this.emit("change:selectedNode",{node:this.selectedNode,old:b})},b.prototype.clearSelected=function(){return this.setSelected(null)},b.prototype.clearPreselected=function(){return this.setPreselected(null)},b.prototype.clearSelectedNode=function(){return this.setSelectedNode(null)},b}(e),c.SelectionView=function(){function a(a,b){this.svgDocument=a,this.model=b,this.onInsertNode=L(this.onInsertNode,this),this.onChangeSelectedNode=L(this.onChangeSelectedNode,this),this.onChangePreselected=L(this.onChangePreselected,this),this.onChangeSelected=L(this.onChangeSelected,this),this.path=null,this.nodeEditors=[],this._nodeEditorPool=[],this.objectSelection=new c.ObjectSelection(this.svgDocument),this.objectPreselection=new c.ObjectSelection(this.svgDocument,{"class":"object-preselection"}),this.model.on("change:selected",this.onChangeSelected),this.model.on("change:preselected",this.onChangePreselected),this.model.on("change:selectedNode",this.onChangeSelectedNode)}return a.prototype.nodeSize=5,a.prototype.getObjectSelection=function(){return this.objectSelection},a.prototype.onChangeSelected=function(a){var b,c;return b=a.object,c=a.old,this._unbindFromObject(c),this._bindToObject(b),this.setSelectedObject(b)},a.prototype.onChangePreselected=function(a){var b;return b=a.object,this.objectPreselection.setObject(b)},a.prototype.onChangeSelectedNode=function(a){var b,c,d;return b=a.node,d=a.old,c=this._findNodeEditorForNode(d),c&&c.setEnableHandles(!1),c=this._findNodeEditorForNode(b),c?c.setEnableHandles(!0):void 0},a.prototype.setSelectedObject=function(a){return this.objectSelection.setObject(a),this._createNodeEditors(a)},a.prototype.onInsertNode=function(a,b){var c,d,e;return e=null!=b?b:{},d=e.node,c=e.index,this._addNodeEditor(d),null},a.prototype._bindToObject=function(a){return a?a.on("insert:node",this.onInsertNode):void 0},a.prototype._unbindFromObject=function(a){return a?a.removeListener("insert:node",this.onInsertNode):void 0},a.prototype._createNodeEditors=function(a){var b,c,d,e,f,g,h,i,j;if(this._nodeEditorPool=this._nodeEditorPool.concat(this.nodeEditors),this.nodeEditors=[],null!=(null!=a?a.getNodes:void 0))for(d=a.getNodes(),e=0,g=d.length;g>e;e++)b=d[e],this._addNodeEditor(b);for(i=this._nodeEditorPool,j=[],f=0,h=i.length;h>f;f++)c=i[f],j.push(c.setNode(null));return j},a.prototype._addNodeEditor=function(a){var b;return a?(b=this._nodeEditorPool.length?this._nodeEditorPool.pop():new c.NodeEditor(this.svgDocument,this.model),b.setNode(a),this.nodeEditors.push(b),!0):!1},a.prototype._findNodeEditorForNode=function(a){var b,c,d,e;for(e=this.nodeEditors,c=0,d=e.length;d>c;c++)if(b=e[c],b.node===a)return b;return null},a}(),H=window._||require("underscore"),q=function(){function a(a,b){this.set(a,b)}return a.create=function(b,c){return b instanceof a?b:Array.isArray(b)?new a(b[0],b[1]):new a(b,c)},a.prototype.set=function(a,b){var c;return this.width=a,this.height=b,H.isArray(this.width)?(c=this.width,this.width=c[0],this.height=c[1],c):void 0},a.prototype.toArray=function(){return[this.width,this.height]},a.prototype.equals=function(b){return b=a.create(b),b.width===this.width&&b.height===this.height},a.prototype.toString=function(){return"("+this.width+", "+this.height+")"},a}(),c.Size=q,H=window._||require("underscore"),e=window.EventEmitter||require("events").EventEmitter,r=function(a){function b(a){var b,c;c=null!=a?a:{},this.path=c.path,this.closed=c.closed,b=c.nodes,this.onNodeChange=L(this.onNodeChange,this),this.nodes=[],this.setNodes(b),this.closed=!!this.closed}return K(b,a),b.prototype.toString=function(){return"Subpath "+this.toPathString()},b.prototype.toPathString=function(){var a,b,c,d,e,f,g,h,i;for(f="",c=null,d=function(a,b){var c;return c="",a.handleOut||b.handleIn?(c=[],c=c.concat(a.getAbsoluteHandleOut().toArray()),c=c.concat(b.getAbsoluteHandleIn().toArray()),c=c.concat(b.point.toArray()),c="C"+c.join(",")):c=a.point.x===b.point.x?"V"+b.point.y:a.point.y===b.point.y?"H"+b.point.x:"L"+b.point.toArray().join(","),c},a=function(a,b){var c;return a&&b?(c="",(b.handleOut||a.handleIn)&&(c+=d(b,a)),c+="Z"):""},i=this.nodes,g=0,h=i.length;h>g;g++)e=i[g],f+=f?d(b,e):"M"+e.point.toArray().join(","),b=e;return this.closed&&(f+=a(this.nodes[0],this.nodes[this.nodes.length-1])),f},b.prototype.getNodes=function(){return this.nodes},b.prototype.setNodes=function(a){var b,c,d,e,f,g;if(a&&H.isArray(a)){for(g=this.nodes,c=0,e=g.length;e>c;c++)b=g[c],this._unbindNode(b);for(d=0,f=a.length;f>d;d++)b=a[d],this._bindNode(b);return this.nodes=a,this.emit("change",this)}},b.prototype.addNode=function(a){return this.insertNode(a,this.nodes.length)},b.prototype.insertNode=function(a,b){return this._bindNode(a),this.nodes.splice(b,0,a),this.emit("insert:node",this,{subpath:this,index:b,node:a}),this.emit("change",this)},b.prototype.close=function(){return this.closed=!0,this.emit("change",this)},b.prototype.translate=function(a){var b,c,d,e;for(a=m.create(a),e=this.nodes,c=0,d=e.length;d>c;c++)b=e[c],b.translate(a)},b.prototype.onNodeChange=function(){return this.emit("change",this)},b.prototype._bindNode=function(a){return a.setPath(this.path),a.on("change",this.onNodeChange)},b.prototype._unbindNode=function(a){return a.setPath(null),a.off("change",this.onNodeChange)},b.prototype._findNodeIndex=function(a){var b,c,d;for(b=c=0,d=this.nodes.length;d>=0?d>c:c>d;b=d>=0?++c:--c)if(this.nodes[b]===a)return b;return-1},b}(e),c.Subpath=r,p=window.SVG||require("./vendor/svg").SVG,s=function(){function a(a){this.objects=[],this.svgDocument=p(a),this.toolLayer=this.svgDocument.group(),this.toolLayer.node.setAttribute("class","tool-layer"),this.selectionModel=new c.SelectionModel,this.selectionView=new c.SelectionView(this.toolLayer,this.selectionModel),this.tool=new c.PointerTool(this.svgDocument,{selectionModel:this.selectionModel,selectionView:this.selectionView}),this.tool.activate()}return a.prototype.deserialize=function(a){return this.objects=c["import"](this.svgDocument,a),this.toolLayer.front()},a.prototype.serialize=function(){var a;return a=this.getSvgRoot(),a?a["export"]({whitespace:!0}):""},a.prototype.getSvgRoot=function(){var a;return a=null,this.svgDocument.each(function(){return"svg"===this.node.nodeName?a=this:void 0}),a},a}(),c.SvgDocument=s,u=/translate\(([-0-9]+)[ ]+([-0-9]+)\)/,t=function(){function a(){this.translation=null,this.transformString=""}return a.prototype.setTransformString=function(a){var b,d,e;return null==a&&(a=""),this.transformString===a?!1:(this.transformString=a,b=u.exec(a),null!=b?(d=parseInt(b[1]),e=parseInt(b[2]),this.translation=new c.Point(d,e)):this.translation=null,!0)},a.prototype.toString=function(){return this.transformString},a.prototype.transformPoint=function(a){return a=c.Point.create(a),this.translation&&(a=a.add(this.translation)),a},a}(),c.Transform=t,H=window._||require("underscore"),a=window.jQuery||require("jquery"),c.Utils={getObjectFromNode:function(b){return a.data(b,"curve.object")},setObjectOnNode:function(b,c){return a.data(b,"curve.object",c)},pointForEvent:function(b,d){var e,f,g,h,i;return e=d.clientX,f=d.clientY,i=a(b.node).offset(),h=i.top,g=i.left,new c.Point(d.clientX-g,d.clientY-h)}}}).call(this);