!function(a){if("object"==typeof exports&&"undefined"!=typeof module)module.exports=a();else if("function"==typeof define&&define.amd)define([],a);else{var b;b="undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:this,b.Curve=a()}}(function(){var a;return function b(a,c,d){function e(g,h){if(!c[g]){if(!a[g]){var i="function"==typeof require&&require;if(!h&&i)return i(g,!0);if(f)return f(g,!0);var j=new Error("Cannot find module '"+g+"'");throw j.code="MODULE_NOT_FOUND",j}var k=c[g]={exports:{}};a[g][0].call(k.exports,function(b){var c=a[g][1][b];return e(c?c:b)},k,k.exports,b,a,c,d)}return c[g].exports}for(var f="function"==typeof require&&require,g=0;g<d.length;g++)e(d[g]);return e}({1:[function(a,b,c){(function(c){(function(){var d,e,f;d=a("./point"),f=function(){var a;return a="undefined"!=typeof c&&null!==c?c:window,null==a.NodeObjectMap&&(a.NodeObjectMap={}),a.NodeObjectMap},e={getObjectFromNode:function(a){return f()[a.id]},setObjectOnNode:function(a,b){return f()[a.id]=b},pointForEvent:function(a,b){var c,e,f,g;return c=b.clientX,e=b.clientY,g=this.svgDocument.node.offsetTop,f=this.svgDocument.node.offsetLeft,new d(b.clientX-f,b.clientY-g)}},b.exports=e}).call(this)}).call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{"./point":15}],2:[function(a,b,c){(function(){a("./ext/svg-circle"),a("./ext/svg-draggable"),a("./ext/svg-export"),b.exports={Point:a("./point"),Size:a("./size"),Transform:a("./transform"),Utils:a("./utils"),Node:a("./node"),Path:a("./path"),Subpath:a("./subpath"),Rectangle:a("./rectangle"),NodeEditor:a("./node-editor"),ObjectEditor:a("./object-editor"),ObjectSelection:a("./object-selection"),PathEditor:a("./path-editor"),PathParser:a("./path-parser"),SelectionModel:a("./selection-model"),SelectionView:a("./selection-view"),PenTool:a("./pen-tool"),PointerTool:a("./pointer-tool"),SVGDocument:a("./svg-document")}}).call(this)},{"./ext/svg-circle":4,"./ext/svg-draggable":5,"./ext/svg-export":6,"./node":8,"./node-editor":7,"./object-editor":9,"./object-selection":10,"./path":13,"./path-editor":11,"./path-parser":12,"./pen-tool":14,"./point":15,"./pointer-tool":16,"./rectangle":17,"./selection-model":18,"./selection-view":19,"./size":20,"./subpath":21,"./svg-document":22,"./transform":23,"./utils":24}],3:[function(a,b,c){(function(){var c,d,e,f,g;c=a("./path"),d=a("./rectangle"),b.exports=function(a,b){var f,g,h,i;return f={path:function(b){return[new c(a,{svgEl:b})]},rect:function(b){return[new d(a,{svgEl:b})]}},h=document.createElement("div"),i={},h.innerHTML=b.replace(/\n/,"").replace(/<(\w+)([^<]+?)\/>/g,"<$1$2></$1>"),g=[],e(h.childNodes,a,0,i,function(){var a;return a=this.node.nodeName,f[a]&&(g=g.concat(f[a](this))),null}),h=null,window.objs=g,g},e=function(a,b,c,d,h){var i,j,k,l,m,n,o,p,q,r,s,t,u,v;for(n=p=0,r=a.length;r>=0?r>p:p>r;n=r>=0?++p:--p){switch(j=a[n],i={},k=[],v=j.nodeName.toLowerCase(),i=f(j),v){case"path":l=b[v]();break;case"polygon":l=b[v]();break;case"polyline":l=b[v]();break;case"rect":l=b[v](0,0);break;case"circle":l=b[v](0,0);break;case"ellipse":l=b[v](0,0);break;case"line":l=b.line(0,0,0,0);break;case"text":if(0===j.childNodes.length)l=b[v](j.textContent);else for(l=null,o=q=0,s=j.childNodes.length;s>=0?s>q:q>s;o=s>=0?++q:--q)m=j.childNodes[o],"tspan"===m.nodeName.toLowerCase()&&(null===l?l=b[v](m.textContent):l.tspan(m.textContent).attr(f(m)));break;case"image":l=b.image(i["xlink:href"]);break;case"g":case"svg":l=b["g"===v?"group":"nested"](),e(j.childNodes,l,c+1,d,h);break;case"defs":e(j.childNodes,b.defs(),c+1,d,h);break;case"use":l=b.use();break;case"clippath":case"mask":l=b[null!=(t="mask"===v)?t:{mask:"clip"}](),e(j.childNodes,l,c+1,d,h);break;case"lineargradient":case"radialgradient":l=b.defs().gradient(v.split("gradient")[0],function(a){var b,c,d;for(d=[],o=b=0,c=j.childNodes.length;c>=0?c>b:b>c;o=c>=0?++b:--b)d.push(a.at(f(j.childNodes[o])).style(j.childNodes[o].getAttribute("style")));return d});break;case"#comment":case"#text":case"metadata":case"desc":break;default:console.log("SVG Import got unexpected type "+v,j)}l&&(u=g(i.transform),delete i.transform,l.attr(i).transform(u),l.attr("id")&&(d[l.attr("id")]=l),"text"===v&&l.rebuild(),"function"==typeof h&&h.call(l))}return b},f=function(a){var b,c,d,e,f;if(c=a.attributes||[],b={},c.length)for(d=e=f=c.length-1;0>=f?0>=e:e>=0;d=0>=f?++e:--e)b[c[d].nodeName]=c[d].nodeValue;return b},g=function(a){var b,c,d,e,f,g,h,i;if(h={},e=(a||"").match(/[A-Za-z]+\([^\)]+\)/g)||[],b=SVG.defaults.trans(),e.length)for(c=d=f=e.length-1;0>=f?0>=d:d>=0;c=0>=f?++d:--d)switch(g=e[c].match(/([A-Za-z]+)\(([^\)]+)\)/),i=(g[2]||"").replace(/^\s+/,"").replace(/,/g," ").replace(/\s+/g," ").split(" "),g[1]){case"matrix":h.a=parseFloat(i[0])||b.a,h.b=parseFloat(i[1])||b.b,h.c=parseFloat(i[2])||b.c,h.d=parseFloat(i[3])||b.d,h.e=parseFloat(i[4])||b.e,h.f=parseFloat(i[5])||b.f;break;case"rotate":h.rotation=parseFloat(i[0])||b.rotation,h.cx=parseFloat(i[1])||b.cx,h.cy=parseFloat(i[2])||b.cy;break;case"scale":h.scaleX=parseFloat(i[0])||b.scaleX,h.scaleY=parseFloat(i[1])||b.scaleY;break;case"skewX":h.skewX=parseFloat(i[0])||b.skewX;break;case"skewY":h.skewY=parseFloat(i[0])||b.skewY;break;case"translate":h.x=parseFloat(i[0])||b.x,h.y=parseFloat(i[1])||b.y}return h}}).call(this)},{"./path":13,"./rectangle":17}],4:[function(a,b,c){(function(){var b,c=function(a,b){function c(){this.constructor=a}for(var e in b)d.call(b,e)&&(a[e]=b[e]);return c.prototype=b.prototype,a.prototype=new c,a.__super__=b.prototype,a},d={}.hasOwnProperty;b=a("../../vendor/svg.js"),b.Circle=function(a){function d(){d.__super__.constructor.call(this,b.create("circle"))}return c(d,a),d.prototype.cx=function(a){return null===a?this.attr("cx"):this.attr("cx",new b.Number(a).divide(this.trans.scaleX))},d.prototype.cy=function(a){return null===a?this.attr("cy"):this.attr("cy",new b.Number(a).divide(this.trans.scaleY))},d.prototype.radius=function(a){return this.attr({r:new b.Number(a)})},d}(b.Shape),b.extend(b.Container,{circle:function(a){return this.put(new b.Circle).radius(a).move(0,0)}})}).call(this)},{"../../vendor/svg.js":26}],5:[function(a,b,c){(function(){var b,c,d,e,f,g,h;b=a("../../vendor/svg"),c=/translate\(([-0-9]+) ([-0-9]+)\)/,b.extend(b.Element,{draggable:function(){var a,b,c,i;return b=this,"function"==typeof this.fixed&&this.fixed(),i=function(e){return h(b,e),d(a,c)},a=function(a){return f(b,a)},c=function(d){return g(b,d),e(a,c)},b.on("mousedown",i),b.fixed=function(){return b.removeListener("mousedown",i),e(),i=a=c=null,b},this}}),d=function(a,c){return b.on(window,"mousemove",a),b.on(window,"mouseup",c)},e=function(a,c){return b.removeListener(window,"mousemove",a),b.removeListener(window,"mouseup",c)},h=function(a,d){var e,f,g,h,i,j;return null==d&&(d=window.event),e=a.parent._parent(b.Nested)||a._parent(b.Doc),a.startEvent=d,h=i=0,g=c.exec(a.attr("transform")),null!=g&&(h=parseInt(g[1]),i=parseInt(g[2])),j=e.viewbox().zoom,f=a.transform("rotation")*Math.PI/180,a.startPosition={x:h,y:i,zoom:j,rotation:f},"function"==typeof a.dragstart&&a.dragstart({x:0,y:0,zoom:j},d),d.preventDefault?d.preventDefault():d.returnValue=!1},f=function(a,b){var c,d,e,f;return null==b&&(b=window.event),a.startEvent?(d=a.startPosition.rotation,c={x:b.pageX-a.startEvent.pageX,y:b.pageY-a.startEvent.pageY,zoom:a.startPosition.zoom},e=a.startPosition.x+(c.x*Math.cos(d)+c.y*Math.sin(d))/a.startPosition.zoom,f=a.startPosition.y+(c.y*Math.cos(d)+c.x*Math.sin(-d))/a.startPosition.zoom,a.transform({x:e,y:f}),"function"==typeof a.dragmove?a.dragmove(c,b):void 0):void 0},g=function(a,b){var c;return null==b&&(b=window.event),c={x:b.pageX-a.startEvent.pageX,y:b.pageY-a.startEvent.pageY,zoom:a.startPosition.zoom},a.startEvent=null,a.startPosition=null,"function"==typeof a.dragend?a.dragend(c,b):void 0}}).call(this)},{"../../vendor/svg":26}],6:[function(a,b,c){(function(){var b;b=a("../../vendor/svg"),b.extend(b.Element,{"export":function(a,c){var d,e,f,g,h,i,j,k,l,m,n,o;if(j=this.node.nodeName,k="",f="svg"===j&&!c,a=a||{},!a.exclude||!a.exclude.call(this)){if(a=a||{},c=c||0,f&&(k+=this._whitespaced('<?xml version="1.0" encoding="UTF-8"?>',a.whitespace,c),o=this.attr("width"),d=this.attr("height"),a.width&&this.attr("width",a.width),a.height&&this.attr("height",a.height)),k+=this._whitespaced("<"+j+this.attrToString()+">",a.whitespace,c),f&&(this.attr({width:o,height:d}),k+=this._whitespaced("<desc>Created with Curve</desc>",a.whitespace,c+1),this._defs)){for(k+=this._whitespaced("<defs>",a.whitespace,c+1),e=g=0,l=this._defs.children().length;l>=0?l>g:g>l;e=l>=0?++g:--g)k+=this._defs.children()[e]["export"](a,c+2);k+=this._whitespaced("</defs>",a.whitespace,c+1)}if(this instanceof b.Container)for(e=h=0,m=this.children().length;m>=0?m>h:h>m;e=m>=0?++h:--h)k+=this.children()[e]["export"](a,c+1);else if(this instanceof b.Text)for(e=i=0,n=this.lines.length;n>=0?n>i:i>n;e=n>=0?++i:--i)k+=this.lines[e]["export"](a,c+1);this instanceof b.TSpan&&(k+=this._whitespaced(this.node.firstChild.nodeValue,a.whitespace,c+1)),k+=this._whitespaced("</"+j+">",a.whitespace,c)}return k},exportAttr:function(a){return 0===arguments.length?this.data("svg-export-attr"):this.data("svg-export-attr",a)},attrToString:function(){var a,b,c,d,e,f;if(a=[],b=this.exportAttr(),c=this.attr(),"object"==typeof b)for(e in b)"data-svg-export-attr"!==e&&(c[e]=b[e]);for(e in c)f=c[e],"xlink"===e&&(e="xmlns:xlink"),d="id"===e&&f.indexOf("Svgjs")>-1,!d&&"data-svg-export-attr"!==e&&("stroke"!==e||parseFloat(c["stroke-width"])>0)&&a.push(e+'="'+f+'"');return a.length?" "+a.join(" "):""},_whitespaced:function(a,b,c){var d,e,f,g,h;if(b){if(h="",g=b===!0?"  ":b||"",c)for(d=e=f=c-1;0>=f?0>=e:e>=0;d=0>=f?++e:--e)h+=g;a=h+a+"\n"}return a}})}).call(this)},{"../../vendor/svg":26}],7:[function(a,b,c){(function(){var c,d,e=function(a,b){return function(){return a.apply(b,arguments)}};d=a("./point"),b.exports=c=function(){function a(a,b){this.svgToolParent=a,this.pathEditor=b,this.onDraggingHandleOut=e(this.onDraggingHandleOut,this),this.onDraggingHandleIn=e(this.onDraggingHandleIn,this),this.onDraggingNode=e(this.onDraggingNode,this),this.render=e(this.render,this),this.svgDocument=this.svgToolParent.parent,this._setupNodeElement(),this._setupLineElement(),this._setupHandleElements(),this.hide()}var b,c,f,g;return a.prototype.nodeSize=5,a.prototype.handleSize=3,f=null,g=null,b=null,c=null,a.prototype.hide=function(){return this.visible=!1,this.lineElement.hide(),this.nodeElement.hide(),this.handleElements.hide()},a.prototype.show=function(a){return this.visible=!0,this.nodeElement.show(),a&&(this.lineElement.front(),this.nodeElement.front(),this.handleElements.front()),this.enableHandles?(this.lineElement.show(),this.handleElements.show()):(this.lineElement.hide(),this.handleElements.hide())},a.prototype.setEnableHandles=function(a){return this.enableHandles=a,this.visible?this.show():void 0},a.prototype.setNode=function(a){return this._unbindNode(this.node),this.node=a,this._bindNode(this.node),this.setEnableHandles(!1),this.render()},a.prototype.render=function(){var a,b,c,d;return this.node?(a=this.node.getAbsoluteHandleIn(),b=this.node.getAbsoluteHandleOut(),d=this.node.getPoint(),c="M"+a.x+","+a.y+"L"+d.x+","+d.y+"L"+b.x+","+b.y,this.lineElement.attr({d:c}),this.handleElements.members[0].attr({cx:a.x,cy:a.y,transform:""}),this.handleElements.members[1].attr({cx:b.x,cy:b.y,transform:""}),this.nodeElement.attr({cx:d.x,cy:d.y,transform:""}),this.show(),this._draggingHandle?this._draggingHandle.front():void 0):this.hide()},a.prototype.onDraggingNode=function(a,b){return this.node.setPoint(this.pointForEvent(b))},a.prototype.onDraggingHandleIn=function(a,b){return this.node.setAbsoluteHandleIn(this.pointForEvent(b))},a.prototype.onDraggingHandleOut=function(a,b){return this.node.setAbsoluteHandleOut(this.pointForEvent(b))},a.prototype.pointForEvent=function(a){var b,c,e,f;return b=a.clientX,c=a.clientY,f=this._getOffsetTop(),e=this._getOffsetLeft(),new d(a.clientX-e,a.clientY-f)},a.prototype._getOffsetTop=function(){return this.svgDocument.node.offsetTop},a.prototype._getOffsetLeft=function(){return this.svgDocument.node.offsetLeft},a.prototype._bindNode=function(a){var b;if(a)return a.addListener("change",this.render),null!=(b=a.getPath())?b.addListener("change",this.render):void 0},a.prototype._unbindNode=function(a){var b;if(a)return a.removeListener("change",this.render),null!=(b=a.getPath())?b.addListener("change",this.render):void 0},a.prototype._setupNodeElement=function(){return this.nodeElement=this.svgToolParent.circle(this.nodeSize),this.nodeElement.node.setAttribute("class","node-editor-node"),this.nodeElement.click(function(a){return function(b){return b.stopPropagation(),a.setEnableHandles(!0),a.pathEditor.activateNode(a.node),!1}}(this)),this.nodeElement.draggable(),this.nodeElement.dragstart=function(a){return function(){return a.pathEditor.activateNode(a.node)}}(this),this.nodeElement.dragmove=this.onDraggingNode,this.nodeElement.on("mouseover",function(a){return function(){return a.nodeElement.front(),a.nodeElement.attr({r:a.nodeSize+2})}}(this)),this.nodeElement.on("mouseout",function(a){return function(){return a.nodeElement.attr({r:a.nodeSize})}}(this))},a.prototype._setupLineElement=function(){return this.lineElement=this.svgToolParent.path(""),this.lineElement.node.setAttribute("class","node-editor-lines")},a.prototype._setupHandleElements=function(){var a,b,c;return c=this,this.handleElements=this.svgToolParent.set(),this.handleElements.add(this.svgToolParent.circle(this.handleSize),this.svgToolParent.circle(this.handleSize)),this.handleElements.members[0].node.setAttribute("class","node-editor-handle"),this.handleElements.members[1].node.setAttribute("class","node-editor-handle"),this.handleElements.click(function(a){return function(a){return a.stopPropagation(),!1}}(this)),a=function(){return c._draggingHandle=this},b=function(){return c._draggingHandle=null},this.handleElements.members[0].draggable(),this.handleElements.members[0].dragmove=this.onDraggingHandleIn,this.handleElements.members[0].dragstart=a,this.handleElements.members[0].dragend=b,this.handleElements.members[1].draggable(),this.handleElements.members[1].dragmove=this.onDraggingHandleOut,this.handleElements.members[1].dragstart=a,this.handleElements.members[1].dragend=b,this.handleElements.on("mouseover",function(){return this.front(),this.attr({r:c.handleSize+2})}),this.handleElements.on("mouseout",function(){return this.attr({r:c.handleSize})})},a}()}).call(this)},{"./point":15}],8:[function(a,b,c){(function(){var c,d,e,f=function(a,b){function c(){this.constructor=a}for(var d in b)g.call(b,d)&&(a[d]=b[d]);return c.prototype=b.prototype,a.prototype=new c,a.__super__=b.prototype,a},g={}.hasOwnProperty;c=a("events").EventEmitter,e=a("./point"),b.exports=d=function(a){function b(a,b,c,d){this.isJoined=null!=d?d:!1,this.setPoint(a),b&&this.setHandleIn(b),c&&this.setHandleOut(c)}return f(b,a),b.prototype.join=function(a){return null==a&&(a="handleIn"),this.isJoined=!0,this["set"+a.replace("h","H")](this[a])},b.prototype.setPath=function(a){this.path=a},b.prototype.getPath=function(){return this.path},b.prototype.getPoint=function(){return this._transformPoint(this.point)},b.prototype.getHandleIn=function(){return this.handleIn},b.prototype.getHandleOut=function(){return this.handleOut},b.prototype.getAbsoluteHandleIn=function(){return this.handleIn?this._transformPoint(this.point.add(this.handleIn)):this.getPoint()},b.prototype.getAbsoluteHandleOut=function(){return this.handleOut?this._transformPoint(this.point.add(this.handleOut)):this.getPoint()},b.prototype.setAbsoluteHandleIn=function(a){return this.setHandleIn(e.create(a).subtract(this.point))},b.prototype.setAbsoluteHandleOut=function(a){return this.setHandleOut(e.create(a).subtract(this.point))},b.prototype.setPoint=function(a){return this.set("point",e.create(a))},b.prototype.setHandleIn=function(a){return a&&(a=e.create(a)),this.set("handleIn",a),this.isJoined?this.set("handleOut",a?new e(0,0).subtract(a):a):void 0},b.prototype.setHandleOut=function(a){return a&&(a=e.create(a)),this.set("handleOut",a),this.isJoined?this.set("handleIn",a?new e(0,0).subtract(a):a):void 0},b.prototype.computeIsjoined=function(){return this.isJoined=!this.handleIn&&!this.handleOut||this.handleIn&&this.handleOut&&Math.round(this.handleIn.x)===Math.round(-this.handleOut.x)&&Math.round(this.handleIn.y)===Math.round(-this.handleOut.y)},b.prototype.set=function(a,b){var c,d,e;return e=this[a],this[a]=b,c="change:"+a,d={event:c,value:b,old:e},this.emit(c,this,d),this.emit("change",this,d)},b.prototype.translate=function(a){return a=e.create(a),this.set("point",this.point.add(a))},b.prototype._transformPoint=function(a){var b,c;return c=null!=(b=this.path)?b.getTransform():void 0,null!=c&&(a=c.transformPoint(a)),a},b}(c)}).call(this)},{"./point":15,events:25}],9:[function(a,b,c){(function(){var c,d,e=function(a,b){return function(){return a.apply(b,arguments)}};d=a("./path-editor"),b.exports=c=function(){function a(a,b){this.svgDocument=a,this.selectionModel=b,this.onChangeSelected=e(this.onChangeSelected,this),this.active=!1,this.activeEditor=null,this.editors={Path:new d(this.svgDocument)}}return a.prototype.isActive=function(){return this.active},a.prototype.getActiveObject=function(){var a,b;return null!=(a=null!=(b=this.activeEditor)?b.getActiveObject():void 0)?a:null},a.prototype.activate=function(){return this.active=!0,this.selectionModel.on("change:selected",this.onChangeSelected)},a.prototype.deactivate=function(){return this.selectionModel.removeListener("change:selected",this.onChangeSelected),this._deactivateActiveEditor(),this.active=!1},a.prototype.onChangeSelected=function(a){var b,c,d;return b=a.object,c=a.old,this._deactivateActiveEditor(),null!=b?(this.activeEditor=this.editors[b.getType()],null!=(d=this.activeEditor)?d.activateObject(b):void 0):void 0},a.prototype._deactivateActiveEditor=function(){var a;return null!=(a=this.activeEditor)&&a.deactivate(),this.activeEditor=null},a}()}).call(this)},{"./path-editor":11}],10:[function(a,b,c){(function(){var c,d,e=function(a,b){return function(){return a.apply(b,arguments)}},f=function(a,b){function c(){this.constructor=a}for(var d in b)g.call(b,d)&&(a[d]=b[d]);return c.prototype=b.prototype,a.prototype=new c,a.__super__=b.prototype,a},g={}.hasOwnProperty;c=a("events").EventEmitter,b.exports=d=function(a){function b(a,b){var c;this.svgDocument=a,this.options=null!=b?b:{},this.render=e(this.render,this),null==(c=this.options)["class"]&&(c["class"]="object-selection")}return f(b,a),b.prototype.setObject=function(a){var b;return this._unbindObject(this.object),b=a,this.object=a,this._bindObject(this.object),this.trackingObject&&this.trackingObject.remove(),this.trackingObject=null,this.object&&(this.trackingObject=this.object.cloneElement(this.svgDocument).back(),this.trackingObject.node.setAttribute("class",this.options["class"]+" invisible-to-hit-test"),this.render()),this.emit("change:object",{objectSelection:this,object:this.object,old:b})},b.prototype.render=function(){return this.object.render(this.trackingObject)},b.prototype._bindObject=function(a){return a?a.on("change",this.render):void 0},b.prototype._unbindObject=function(a){return a?a.removeListener("change",this.render):void 0},b}(c)}).call(this)},{events:25}],11:[function(a,b,c){(function(){var c,d,e=function(a,b){return function(){return a.apply(b,arguments)}};c=a("./node-editor"),b.exports=d=function(){function a(a){this.svgDocument=a,this.onInsertNode=e(this.onInsertNode,this),this.path=null,this.node=null,this.nodeEditors=[],this._nodeEditorPool=[]}return a.prototype.isActive=function(){return!!this.path},a.prototype.getActiveObject=function(){return this.path},a.prototype.activateObject=function(a){return this.deactivate(),null!=a?(this.path=a,this._bindToObject(this.path),this._createNodeEditors(this.path)):void 0},a.prototype.deactivate=function(){return this.deactivateNode(),null!=this.path&&this._unbindFromObject(this.path),this._removeNodeEditors(),this.path=null},a.prototype.activateNode=function(a){var b;return this.deactivateNode(),null!=a&&(this.selectedNode=a,b=this._findNodeEditorForNode(a),null!=b)?b.setEnableHandles(!0):void 0},a.prototype.deactivateNode=function(){var a;return null!=this.selectedNode&&(a=this._findNodeEditorForNode(this.selectedNode),null!=a&&a.setEnableHandles(!1)),this.selectedNode=null},a.prototype.onInsertNode=function(a,b){var c,d,e;return e=null!=b?b:{},d=e.node,c=e.index,this._addNodeEditor(d),null},a.prototype._bindToObject=function(a){return a?a.on("insert:node",this.onInsertNode):void 0},a.prototype._unbindFromObject=function(a){return a?a.removeListener("insert:node",this.onInsertNode):void 0},a.prototype._removeNodeEditors=function(){var a,b,c,d;for(this._nodeEditorPool=this._nodeEditorPool.concat(this.nodeEditors),this.nodeEditors=[],d=this._nodeEditorPool,a=0,b=d.length;b>a;a++)c=d[a],c.setNode(null)},a.prototype._createNodeEditors=function(a){var b,c,d,e;if(this._removeNodeEditors(),null!=(null!=a?a.getNodes:void 0))for(e=a.getNodes(),b=0,c=e.length;c>b;b++)d=e[b],this._addNodeEditor(d)},a.prototype._addNodeEditor=function(a){var b;return a?(b=this._nodeEditorPool.length?this._nodeEditorPool.pop():new c(this.svgDocument,this),b.setNode(a),this.nodeEditors.push(b),!0):!1},a.prototype._findNodeEditorForNode=function(a){var b,c,d,e;for(e=this.nodeEditors,b=0,c=e.length;c>b;b++)if(d=e[b],d.node===a)return d;return null},a}()}).call(this)},{"./node-editor":7}],12:[function(a,b,c){(function(){var c,d,e,f,g,h,i,j;e=a("./node"),j=["COMMAND","NUMBER"],c=j[0],d=j[1],h=function(a){var b;return b=g(a),i(f(b))},i=function(a){var b,c,d,f,g,h,i,j,k,l,m,n,o,p,q,r,s,t,u,v,w,x,y,z,A,B,C;if(A={subpaths:[]},1===a.length&&("M"===(u=a[0].type)||"m"===u))return A;for(f=null,g=null,b=function(a){var b;return b=new e(a),g={closed:!1,nodes:[b]},A.subpaths.push(g),b},B=function(a,b){return[a[b],a[b+1]]},r=function(a){var b,c,d,e,g;for(e=[],b=c=0,d=a.length;d>c;b=++c)g=a[b],e.push(g+f[b%2]);return e},d=function(b,c){var d,h,i,j;return f=b,i=null,d=g.nodes[0],h=a[c+1],h&&("z"===(j=h.type)||"Z"===j)&&d&&d.point.equals(f)||(i=new e(f),g.nodes.push(i)),i},k=l=0,v=a.length;v>=0?v>l:l>v;k=v>=0?++l:--l)switch(c=a[k],c.type){case"M":f=c.parameters,b(f);break;case"L":case"l":t=c.parameters,"l"===c.type&&(t=r(t)),d(B(t,0),k);break;case"H":case"h":t=c.parameters,"h"===c.type&&(t=r(t)),d([t[0],f[1]],k);break;case"V":case"v":t=c.parameters,"v"===c.type&&(t=r([0,t[0]]),t=t.slice(1)),d([f[0],t[0]],k);break;case"C":case"c":case"Q":case"q":t=c.parameters,("c"===(w=c.type)||"q"===w)&&(t=r(t)),"C"===(x=c.type)||"c"===x?(f=B(t,4),i=B(t,2),j=B(t,0)):(f=B(t,2),i=j=B(t,0)),o=g.nodes[g.nodes.length-1],o.setAbsoluteHandleOut(j),(s=d(f,k))?s.setAbsoluteHandleIn(i):(h=g.nodes[0],h.setAbsoluteHandleIn(i));break;case"S":case"s":t=c.parameters,"s"===c.type&&(t=r(t)),f=B(t,2),i=B(t,0),o=g.nodes[g.nodes.length-1],o.join("handleIn"),(s=d(f,k))?s.setAbsoluteHandleIn(i):(h=g.nodes[0],h.setAbsoluteHandleIn(i));break;case"T":case"t":t=c.parameters,"t"===c.type&&(t=r(t)),f=B(t,0),o=g.nodes[g.nodes.length-1],o.join("handleIn"),i=o.getAbsoluteHandleOut(),(s=d(f,k))?s.setAbsoluteHandleIn(i):(h=g.nodes[0],h.setAbsoluteHandleIn(i));break;case"Z":case"z":g.closed=!0}for(y=A.subpaths,m=0,p=y.length;p>m;m++)for(C=y[m],z=C.nodes,n=0,q=z.length;q>n;n++)s=z[n],s.computeIsjoined();return A},f=function(a){var b,e,f,g,h,i,j;for(e=[],f=g=0,i=a.length;i>=0?i>g:g>i;f=i>=0?++g:--g)if(j=a[f],j.type===c){for(b={type:j.string,parameters:[]};(h=a[f+1])&&h.type===d;)b.parameters.push(parseFloat(h.string)),f++;e.push(b)}return e},g=function(a){var b,e,f,g,h,i,j,k,l;for(h="-0123456789.",k=" ,\n	",l=[],e=null,j=function(a){return e&&e.type!==a?i():void 0},i=function(){return e?(e.string.join&&(e.string=e.string.join("")),l.push(e),e=null):void 0},f=0,g=a.length;g>f;f++)b=a[f],h.indexOf(b)>-1?(j(d),"-"===b&&i(),e||(e={type:d,string:[]}),e.string.push(b)):k.indexOf(b)>-1?i():(i(),l.push({type:c,string:b}));return i(),l},b.exports={lexPath:g,parsePath:h,groupCommands:f,parseTokens:i}}).call(this)},{"./node":8}],13:[function(a,b,c){(function(){var c,d,e,f,g,h,i,j,k,l,m,n=function(a,b){return function(){return a.apply(b,arguments)}},o=function(a,b){function c(){this.constructor=a}for(var d in b)p.call(b,d)&&(a[d]=b[d]);return c.prototype=b.prototype,a.prototype=new c,a.__super__=b.prototype,a},p={}.hasOwnProperty;d=a("events").EventEmitter,l=a("./utils"),h=a("./path-parser"),k=a("./transform"),j=a("./subpath"),i=a("./point"),c={fill:"#eee",stroke:"none"},e=0,g=function(a){function b(){this.onSubpathChange=n(this.onSubpathChange,this),this.subpaths=[],this.pathString="",this.transform=new k}return o(b,a),b.prototype.getNodes=function(){var a,b;return a=function(){var a,c,d,e;for(d=this.subpaths,e=[],a=0,c=d.length;c>a;a++)b=d[a],e.push(b.getNodes());return e}.call(this),m(a)},b.prototype.getTransform=function(){return this.transform},b.prototype.getTransformString=function(){return this.transform.toString()},b.prototype.setTransformString=function(a){return this.transform.setTransformString(a)?this._emitChangeEvent():void 0},b.prototype.getPathString=function(){return this.pathString},b.prototype.setPathString=function(a){return a!==this.pathString?this._parseFromPathString(a):void 0},b.prototype.toString=function(){return this.getPathString()},b.prototype.translate=function(a){var b,c,d,e;for(a=i.create(a),d=this.subpaths,b=0,c=d.length;c>b;b++)e=d[b],e.translate(a)},b.prototype.addNode=function(a){return this._addCurrentSubpathIfNotPresent(),this.currentSubpath.addNode(a)},b.prototype.insertNode=function(a,b){return this._addCurrentSubpathIfNotPresent(),this.currentSubpath.insertNode(a,b)},b.prototype.close=function(){return this._addCurrentSubpathIfNotPresent(),this.currentSubpath.close()},b.prototype._addCurrentSubpathIfNotPresent=function(){return this.currentSubpath?void 0:this.currentSubpath=this._createSubpath()},b.prototype.onSubpathChange=function(a,b){return this._updatePathString(),this._emitChangeEvent()},b.prototype._createSubpath=function(a){return null==a&&(a={}),a.path=this,this._addSubpath(new j(a))},b.prototype._addSubpath=function(a){return this.subpaths.push(a),this._bindSubpath(a),this._updatePathString(),a},b.prototype._bindSubpath=function(a){return a?(a.on("change",this.onSubpathChange),a.on("insert:node",this._forwardEvent.bind(this,"insert:node"))):void 0},b.prototype._unbindSubpath=function(a){return a?a.removeAllListeners():void 0},b.prototype._removeAllSubpaths=function(){var a,b,c,d;for(c=this.subpaths,a=0,b=c.length;b>a;a++)d=c[a],this._unbindSubpath(d);return this.subpaths=[]},b.prototype._updatePathString=function(){var a,b;return a=this.pathString,this.pathString=function(){var a,c,d,e;for(d=this.subpaths,e=[],a=0,c=d.length;c>a;a++)b=d[a],e.push(b.toPathString());return e}.call(this).join(" "),a!==this.pathString?this._emitChangeEvent():void 0},b.prototype._parseFromPathString=function(a){var b,c,d,e,f;if(a&&a!==this.pathString){for(this._removeAllSubpaths(),d=h.parsePath(a),f=d.subpaths,b=0,c=f.length;c>b;b++)e=f[b],this._createSubpath(e);return this.currentSubpath=this.subpaths[this.subpaths.length-1],this._updatePathString(),null}},b.prototype._forwardEvent=function(a,b,c){return this.emit(a,this,c)},b.prototype._emitChangeEvent=function(){return this.emit("change",this)},b}(d),b.exports=f=function(a){function b(a,b){var c;this.svgDocument=a,c=(null!=b?b:{}).svgEl,this.onModelChange=n(this.onModelChange,this),this.id=e++,this.model=new g,this.model.on("change",this.onModelChange),this.model.on("insert:node",this._forwardEvent.bind(this,"insert:node")),this._setupSVGObject(c)}return o(b,a),b.prototype.getType=function(){return"Path"},b.prototype.toString=function(){return"Path "+this.id+" "+this.model.toString()},b.prototype.getPathString=function(){return this.model.getPathString()},b.prototype.getNodes=function(){return this.model.getNodes()},b.prototype.getSubpaths=function(){return this.model.subpaths},b.prototype.addNode=function(a){return this.model.addNode(a)},b.prototype.insertNode=function(a,b){return this.model.insertNode(a,b)},b.prototype.close=function(){return this.model.close()},b.prototype.enableDragging=function(a){var b;return b=this.svgEl,null!=b?(this.disableDragging(),b.draggable(),b.dragstart=function(b){return null!=a&&"function"==typeof a.dragstart?a.dragstart(b):void 0},b.dragmove=function(b){return function(c){return b.updateFromAttributes(),null!=a&&"function"==typeof a.dragmove?a.dragmove(c):void 0}}(this),b.dragend=function(b){return function(c){return b.model.setTransformString(null),b.model.translate([c.x,c.y]),null!=a&&"function"==typeof a.dragend?a.dragend(c):void 0}}(this)):void 0},b.prototype.disableDragging=function(){var a;return a=this.svgEl,null!=a?("function"==typeof a.fixed&&a.fixed(),a.dragstart=null,a.dragmove=null,a.dragend=null):void 0},b.prototype.updateFromAttributes=function(){var a,b;return a=this.svgEl.attr("d"),b=this.svgEl.attr("transform"),this.model.setTransformString(b),this.model.setPathString(a)},b.prototype.render=function(a){var b;return null==a&&(a=this.svgEl),b=this.model.getPathString(),b&&a.attr({d:b}),a.attr({transform:this.model.getTransformString()||null})},b.prototype.cloneElement=function(a){var b;return null==a&&(a=this.svgDocument),b=a.path(),this.render(b),b},b.prototype.onModelChange=function(){return this.render(),this.emit("change",this)},b.prototype._forwardEvent=function(a,b,c){return c.path=this,this.emit(a,this,c)},b.prototype._setupSVGObject=function(a){return this.svgEl=a,this.svgEl||(this.svgEl=this.svgDocument.path().attr(c)),l.setObjectOnNode(this.svgEl.node,this),this.model.setPathString(this.svgEl.attr("d"))},b}(d),m=function(a){var b;return b=function(a,b){return Array.isArray(b)?a.concat(m(b)):a.concat(b)},a.reduce(b,[])}}).call(this)},{"./path-parser":12,"./point":15,"./subpath":21,"./transform":23,"./utils":24,events:25}],14:[function(a,b,c){(function(){var c,d,e,f=function(a,b){return function(){return a.apply(b,arguments)}};c=a("./node"),d=a("./path"),b.exports=e=function(){function a(a,b){var c;this.svgDocument=a,c=null!=b?b:{},this.selectionModel=c.selectionModel,this.selectionView=c.selectionView,this.onMouseUp=f(this.onMouseUp,this),this.onMouseMove=f(this.onMouseMove,this),this.onMouseDown=f(this.onMouseDown,this)}return a.prototype.currentObject=null,a.prototype.currentNode=null,a.prototype.activate=function(){return this.svgDocument.on("mousedown",this.onMouseDown),this.svgDocument.on("mousemove",this.onMouseMove),this.svgDocument.on("mouseup",this.onMouseUp)},a.prototype.deactivate=function(){return this.svgDocument.removeListener("mousedown",this.onMouseDown),this.svgDocument.removeListener("mousemove",this.onMouseMove),this.svgDocument.removeListener("mouseup",this.onMouseUp)},a.prototype.onMouseDown=function(a){var b;return b=function(b){return function(){return b.currentNode=new c([a.clientX,a.clientY],[0,0],[0,0]),b.currentObject.addNode(b.currentNode),b.selectionModel.setSelectedNode(b.currentNode)}}(this),this.currentObject?this.selectionView.nodeEditors.length&&a.target===this.selectionView.nodeEditors[0].nodeElement.node?(this.currentObject.close(),this.currentObject=null):b():(this.currentObject=new d(this.svgDocument),this.selectionModel.setSelected(this.currentObject),b())},a.prototype.onMouseMove=function(a){return this.currentNode?this.currentNode.setAbsoluteHandleOut([a.clientX,a.clientY]):void 0},a.prototype.onMouseUp=function(a){return this.currentNode=null},a}()}).call(this)},{"./node":8,"./path":13}],15:[function(a,b,c){(function(){var a;b.exports=a=function(){function a(a,b){this.set(a,b)}return a.create=function(b,c){return b instanceof a?b:Array.isArray(b)?new a(b[0],b[1]):new a(b,c)},a.prototype.set=function(a,b){var c;return this.x=a,this.y=b,Array.isArray(this.x)?(c=this.x,
this.x=c[0],this.y=c[1],c):void 0},a.prototype.add=function(b){return b=a.create(b),new a(this.x+b.x,this.y+b.y)},a.prototype.subtract=function(b){return b=a.create(b),new a(this.x-b.x,this.y-b.y)},a.prototype.toArray=function(){return[this.x,this.y]},a.prototype.equals=function(b){return b=a.create(b),b.x===this.x&&b.y===this.y},a.prototype.toString=function(){return"("+this.x+", "+this.y+")"},a}()}).call(this)},{}],16:[function(a,b,c){(function(){var c,d,e,f=function(a,b){return function(){return a.apply(b,arguments)}};c=a("./object-editor"),e=a("./Utils"),b.exports=d=function(){function a(a,b){var d;this.svgDocument=a,d=null!=b?b:{},this.selectionModel=d.selectionModel,this.selectionView=d.selectionView,this.toolLayer=d.toolLayer,this.onMouseMove=f(this.onMouseMove,this),this.onClick=f(this.onClick,this),this.onChangedSelectedObject=f(this.onChangedSelectedObject,this),this._evrect=this.svgDocument.node.createSVGRect(),this._evrect.width=this._evrect.height=1,this.objectEditor=new c(this.toolLayer,this.selectionModel)}return a.prototype.activate=function(){var a;return this.objectEditor.activate(),this.svgDocument.on("click",this.onClick),this.svgDocument.on("mousemove",this.onMouseMove),a=this.selectionView.getObjectSelection(),a.on("change:object",this.onChangedSelectedObject)},a.prototype.deactivate=function(){var a;return this.objectEditor.deactivate(),this.svgDocument.removeListener("click",this.onClick),this.svgDocument.removeListener("mousemove",this.onMouseMove),a=this.selectionView.getObjectSelection(),a.removeListener("change:object",this.onChangedSelectedObject)},a.prototype.onChangedSelectedObject=function(a){var b,c;return b=a.object,c=a.old,null!=b?b.enableDragging():null!=c?c.disableDragging():void 0},a.prototype.onClick=function(a){var b;return b=this._hitWithTarget(a),this.selectionModel.setSelected(b),b?!1:void 0},a.prototype.onMouseMove=function(a){return this.selectionModel.setPreselected(this._hitWithTarget(a))},a.prototype._hitWithTarget=function(a){var b;return b=null,a.target!==this.svgDocument.node&&(b=e.getObjectFromNode(a.target)),b},a.prototype._hitWithIntersectionList=function(a){var b,c,d,f,g,h,i,j;if(j=this.svgDocument.node.offsetTop,f=this.svgDocument.node.offsetLeft,this._evrect.x=a.clientX-f,this._evrect.y=a.clientY-j,g=this.svgDocument.node.getIntersectionList(this._evrect,null),h=null,g.length)for(c=d=i=g.length-1;0>=i?0>=d:d>=0;c=0>=i?++d:--d)if(b=g[c].getAttribute("class"),!(b&&b.indexOf("invisible-to-hit-test")>-1)){h=e.getObjectFromNode(g[c]);break}return console.log(h),h},a}()}).call(this)},{"./Utils":1,"./object-editor":9}],17:[function(a,b,c){(function(){var c,d,e,f,g,h,i,j,k,l=function(a,b){function c(){this.constructor=a}for(var d in b)m.call(b,d)&&(a[d]=b[d]);return c.prototype=b.prototype,a.prototype=new c,a.__super__=b.prototype,a},m={}.hasOwnProperty,n=function(a,b){return function(){return a.apply(b,arguments)}};d=a("events").EventEmitter,j=a("./transform"),k=a("./utils"),f=a("./point"),i=a("./size"),c={x:0,y:0,width:10,height:10,fill:"#eee",stroke:"none"},e=0,h=function(a){function b(){this.id=e++,this.transform=new j}return l(b,a),b.prototype.position=null,b.prototype.size=null,b.prototype.transform=null,b.prototype.getTransform=function(){return this.transform},b.prototype.getTransformString=function(){return this.transform.toString()},b.prototype.setTransformString=function(a){return this.transform.setTransformString(a)?this._emitChangeEvent():void 0},b.prototype.getPosition=function(){return this.position},b.prototype.setPosition=function(a,b){return this.position=f.create(a,b),this._emitChangeEvent()},b.prototype.getSize=function(){return this.size},b.prototype.setSize=function(a,b){return this.size=i.create(a,b),this._emitChangeEvent()},b.prototype.toString=function(){return"{Rect "+this.id+": "+this.position+" "+this.size},b.prototype.translate=function(a){return a=f.create(a),this.setPosition(this.position.add(a)),this._emitChangeEvent()},b.prototype._emitChangeEvent=function(){return this.emit("change",this)},b}(d),b.exports=g=function(a){function b(a,b){var c;this.svgDocument=a,c=(null!=b?b:{}).svgEl,this.onModelChange=n(this.onModelChange,this),this.model=new h,this._setupSVGObject(c),this.model.on("change",this.onModelChange)}return l(b,a),b.prototype.getType=function(){return"Rectangle"},b.prototype.toString=function(){return this.model.toString()},b.prototype.enableDragging=function(a){var b;return b=this.svgEl,null!=b?(this.disableDragging(),b.draggable(),b.dragstart=function(b){return null!=a&&"function"==typeof a.dragstart?a.dragstart(b):void 0},b.dragmove=function(b){return function(c){return b.updateFromAttributes(),null!=a&&"function"==typeof a.dragmove?a.dragmove(c):void 0}}(this),b.dragend=function(b){return function(c){return b.model.setTransformString(null),b.model.translate([c.x,c.y]),null!=a&&"function"==typeof a.dragend?a.dragend(c):void 0}}(this)):void 0},b.prototype.disableDragging=function(){var a;return a=this.svgEl,null!=a?("function"==typeof a.fixed&&a.fixed(),a.dragstart=null,a.dragmove=null,a.dragend=null):void 0},b.prototype.updateFromAttributes=function(){var a,b,c,d,e;return d=this.svgEl.attr("x"),e=this.svgEl.attr("y"),c=this.svgEl.attr("width"),a=this.svgEl.attr("height"),b=this.svgEl.attr("transform"),this.model.setPosition(d,e),this.model.setSize(c,a),this.model.setTransformString(b)},b.prototype.render=function(a){var b,c;return null==a&&(a=this.svgEl),b=this.model.getPosition(),c=this.model.getSize(),a.attr({x:b.x}),a.attr({y:b.y}),a.attr({width:c.width}),a.attr({height:c.height}),a.attr({transform:this.model.getTransformString()||null})},b.prototype.cloneElement=function(a){var b;return null==a&&(a=this.svgDocument),b=a.rect(),this.render(b),b},b.prototype.onModelChange=function(){return this.render(),this.emit("change",this)},b.prototype._setupSVGObject=function(a){return this.svgEl=a,this.svgEl||(this.svgEl=this.svgDocument.rect().attr(c)),k.setObjectOnNode(this.svgEl.node,this),this.updateFromAttributes()},b}(d)}).call(this)},{"./point":15,"./size":20,"./transform":23,"./utils":24,events:25}],18:[function(a,b,c){(function(){var c,d,e=function(a,b){function c(){this.constructor=a}for(var d in b)f.call(b,d)&&(a[d]=b[d]);return c.prototype=b.prototype,a.prototype=new c,a.__super__=b.prototype,a},f={}.hasOwnProperty;c=a("events").EventEmitter,b.exports=d=function(a){function b(){this.preselected=null,this.selected=null,this.selectedNode=null}return e(b,a),b.prototype.setPreselected=function(a){var b;if(a!==this.preselected&&(!a||a!==this.selected))return b=this.preselected,this.preselected=a,this.emit("change:preselected",{object:this.preselected,old:b})},b.prototype.setSelected=function(a){var b;if(a!==this.selected)return b=this.selected,this.selected=a,this.preselected===a&&this.setPreselected(null),this.emit("change:selected",{object:this.selected,old:b})},b.prototype.setSelectedNode=function(a){var b;if(a!==this.selectedNode)return b=this.selectedNode,this.selectedNode=a,this.emit("change:selectedNode",{node:this.selectedNode,old:b})},b.prototype.clearSelected=function(){return this.setSelected(null)},b.prototype.clearPreselected=function(){return this.setPreselected(null)},b.prototype.clearSelectedNode=function(){return this.setSelectedNode(null)},b}(c)}).call(this)},{events:25}],19:[function(a,b,c){(function(){var c,d,e=function(a,b){return function(){return a.apply(b,arguments)}};c=a("./object-selection"),b.exports=d=function(){function a(a,b){this.svgDocument=a,this.model=b,this.onChangePreselected=e(this.onChangePreselected,this),this.onChangeSelected=e(this.onChangeSelected,this),this.objectSelection=new c(this.svgDocument),this.objectPreselection=new c(this.svgDocument,{"class":"object-preselection"}),this.model.on("change:selected",this.onChangeSelected),this.model.on("change:preselected",this.onChangePreselected)}return a.prototype.getObjectSelection=function(){return this.objectSelection},a.prototype.onChangeSelected=function(a){var b,c;return b=a.object,c=a.old,this.objectSelection.setObject(b)},a.prototype.onChangePreselected=function(a){var b;return b=a.object,this.objectPreselection.setObject(b)},a}()}).call(this)},{"./object-selection":10}],20:[function(a,b,c){(function(){var a;b.exports=a=function(){function a(a,b){this.set(a,b)}return a.create=function(b,c){return b instanceof a?b:Array.isArray(b)?new a(b[0],b[1]):new a(b,c)},a.prototype.set=function(a,b){var c;return this.width=a,this.height=b,Array.isArray(this.width)?(c=this.width,this.width=c[0],this.height=c[1],c):void 0},a.prototype.toArray=function(){return[this.width,this.height]},a.prototype.equals=function(b){return b=a.create(b),b.width===this.width&&b.height===this.height},a.prototype.toString=function(){return"("+this.width+", "+this.height+")"},a}()}).call(this)},{}],21:[function(a,b,c){(function(){var c,d,e,f=function(a,b){return function(){return a.apply(b,arguments)}},g=function(a,b){function c(){this.constructor=a}for(var d in b)h.call(b,d)&&(a[d]=b[d]);return c.prototype=b.prototype,a.prototype=new c,a.__super__=b.prototype,a},h={}.hasOwnProperty;c=a("events").EventEmitter,d=a("./point"),b.exports=e=function(a){function b(a){var b,c;c=null!=a?a:{},this.path=c.path,this.closed=c.closed,b=c.nodes,this.onNodeChange=f(this.onNodeChange,this),this.nodes=[],this.setNodes(b),this.closed=!!this.closed}return g(b,a),b.prototype.toString=function(){return"Subpath "+this.toPathString()},b.prototype.toPathString=function(){var a,b,c,d,e,f,g,h,i;for(h="",d=null,f=function(a,b){var c;return c="",a.handleOut||b.handleIn?(c=[],c=c.concat(a.getAbsoluteHandleOut().toArray()),c=c.concat(b.getAbsoluteHandleIn().toArray()),c=c.concat(b.point.toArray()),c="C"+c.join(",")):c=a.point.x===b.point.x?"V"+b.point.y:a.point.y===b.point.y?"H"+b.point.x:"L"+b.point.toArray().join(","),c},a=function(a,b){var c;return a&&b?(c="",(b.handleOut||a.handleIn)&&(c+=f(b,a)),c+="Z"):""},i=this.nodes,b=0,e=i.length;e>b;b++)g=i[b],h+=h?f(c,g):"M"+g.point.toArray().join(","),c=g;return this.closed&&(h+=a(this.nodes[0],this.nodes[this.nodes.length-1])),h},b.prototype.getNodes=function(){return this.nodes},b.prototype.setNodes=function(a){var b,c,d,e,f,g;if(a&&Array.isArray(a)){for(g=this.nodes,b=0,d=g.length;d>b;b++)f=g[b],this._unbindNode(f);for(c=0,e=a.length;e>c;c++)f=a[c],this._bindNode(f);return this.nodes=a,this.emit("change",this)}},b.prototype.addNode=function(a){return this.insertNode(a,this.nodes.length)},b.prototype.insertNode=function(a,b){return this._bindNode(a),this.nodes.splice(b,0,a),this.emit("insert:node",this,{subpath:this,index:b,node:a}),this.emit("change",this)},b.prototype.close=function(){return this.closed=!0,this.emit("change",this)},b.prototype.translate=function(a){var b,c,e,f;for(a=d.create(a),f=this.nodes,b=0,c=f.length;c>b;b++)e=f[b],e.translate(a)},b.prototype.onNodeChange=function(){return this.emit("change",this)},b.prototype._bindNode=function(a){return a.setPath(this.path),a.on("change",this.onNodeChange)},b.prototype._unbindNode=function(a){return a.setPath(null),a.removeListener("change",this.onNodeChange)},b.prototype._findNodeIndex=function(a){var b,c,d;for(b=c=0,d=this.nodes.length;d>=0?d>c:c>d;b=d>=0?++c:--c)if(this.nodes[b]===a)return b;return-1},b}(c)}).call(this)},{"./point":15,events:25}],22:[function(a,b,c){(function(){var c,d,e,f,g,h;e=a("../vendor/svg"),g=a("./selection-model"),h=a("./selection-view"),d=a("./pointer-tool"),c=a("./deserialize-svg"),b.exports=f=function(){function a(a){this.objects=[],this.svgDocument=e(a),this.toolLayer=this.svgDocument.group(),this.toolLayer.node.setAttribute("class","tool-layer"),this.selectionModel=new g,this.selectionView=new h(this.toolLayer,this.selectionModel),this.tool=new d(this.svgDocument,{selectionModel:this.selectionModel,selectionView:this.selectionView,toolLayer:this.toolLayer}),this.tool.activate()}return a.prototype.deserialize=function(a){return this.objects=c(this.svgDocument,a),this.toolLayer.front()},a.prototype.serialize=function(){var a;return a=this.getSvgRoot(),a?a["export"]({whitespace:!0}):""},a.prototype.getSvgRoot=function(){var a;return a=null,this.svgDocument.each(function(){return"svg"===this.node.nodeName?a=this:void 0}),a},a}()}).call(this)},{"../vendor/svg":26,"./deserialize-svg":3,"./pointer-tool":16,"./selection-model":18,"./selection-view":19}],23:[function(a,b,c){(function(){var c,d,e;c=a("./point"),e=/translate\(([-0-9]+)[ ]+([-0-9]+)\)/,b.exports=d=function(){function a(){this.translation=null,this.transformString=""}return a.prototype.setTransformString=function(a){var b,d,f;return null==a&&(a=""),this.transformString===a?!1:(this.transformString=a,b=e.exec(a),null!=b?(d=parseInt(b[1]),f=parseInt(b[2]),this.translation=new c(d,f)):this.translation=null,!0)},a.prototype.toString=function(){return this.transformString},a.prototype.transformPoint=function(a){return a=c.create(a),this.translation&&(a=a.add(this.translation)),a},a}()}).call(this)},{"./point":15}],24:[function(a,b,c){arguments[4][1][0].apply(c,arguments)},{"./point":15,dup:1}],25:[function(a,b,c){function d(){this._events=this._events||{},this._maxListeners=this._maxListeners||void 0}function e(a){return"function"==typeof a}function f(a){return"number"==typeof a}function g(a){return"object"==typeof a&&null!==a}function h(a){return void 0===a}b.exports=d,d.EventEmitter=d,d.prototype._events=void 0,d.prototype._maxListeners=void 0,d.defaultMaxListeners=10,d.prototype.setMaxListeners=function(a){if(!f(a)||0>a||isNaN(a))throw TypeError("n must be a positive number");return this._maxListeners=a,this},d.prototype.emit=function(a){var b,c,d,f,i,j;if(this._events||(this._events={}),"error"===a&&(!this._events.error||g(this._events.error)&&!this._events.error.length)){if(b=arguments[1],b instanceof Error)throw b;throw TypeError('Uncaught, unspecified "error" event.')}if(c=this._events[a],h(c))return!1;if(e(c))switch(arguments.length){case 1:c.call(this);break;case 2:c.call(this,arguments[1]);break;case 3:c.call(this,arguments[1],arguments[2]);break;default:for(d=arguments.length,f=new Array(d-1),i=1;d>i;i++)f[i-1]=arguments[i];c.apply(this,f)}else if(g(c)){for(d=arguments.length,f=new Array(d-1),i=1;d>i;i++)f[i-1]=arguments[i];for(j=c.slice(),d=j.length,i=0;d>i;i++)j[i].apply(this,f)}return!0},d.prototype.addListener=function(a,b){var c;if(!e(b))throw TypeError("listener must be a function");if(this._events||(this._events={}),this._events.newListener&&this.emit("newListener",a,e(b.listener)?b.listener:b),this._events[a]?g(this._events[a])?this._events[a].push(b):this._events[a]=[this._events[a],b]:this._events[a]=b,g(this._events[a])&&!this._events[a].warned){var c;c=h(this._maxListeners)?d.defaultMaxListeners:this._maxListeners,c&&c>0&&this._events[a].length>c&&(this._events[a].warned=!0,console.error("(node) warning: possible EventEmitter memory leak detected. %d listeners added. Use emitter.setMaxListeners() to increase limit.",this._events[a].length),"function"==typeof console.trace&&console.trace())}return this},d.prototype.on=d.prototype.addListener,d.prototype.once=function(a,b){function c(){this.removeListener(a,c),d||(d=!0,b.apply(this,arguments))}if(!e(b))throw TypeError("listener must be a function");var d=!1;return c.listener=b,this.on(a,c),this},d.prototype.removeListener=function(a,b){var c,d,f,h;if(!e(b))throw TypeError("listener must be a function");if(!this._events||!this._events[a])return this;if(c=this._events[a],f=c.length,d=-1,c===b||e(c.listener)&&c.listener===b)delete this._events[a],this._events.removeListener&&this.emit("removeListener",a,b);else if(g(c)){for(h=f;h-->0;)if(c[h]===b||c[h].listener&&c[h].listener===b){d=h;break}if(0>d)return this;1===c.length?(c.length=0,delete this._events[a]):c.splice(d,1),this._events.removeListener&&this.emit("removeListener",a,b)}return this},d.prototype.removeAllListeners=function(a){var b,c;if(!this._events)return this;if(!this._events.removeListener)return 0===arguments.length?this._events={}:this._events[a]&&delete this._events[a],this;if(0===arguments.length){for(b in this._events)"removeListener"!==b&&this.removeAllListeners(b);return this.removeAllListeners("removeListener"),this._events={},this}if(c=this._events[a],e(c))this.removeListener(a,c);else for(;c.length;)this.removeListener(a,c[c.length-1]);return delete this._events[a],this},d.prototype.listeners=function(a){var b;return b=this._events&&this._events[a]?e(this._events[a])?[this._events[a]]:this._events[a].slice():[]},d.listenerCount=function(a,b){var c;return c=a._events&&a._events[b]?e(a._events[b])?1:a._events[b].length:0}},{}],26:[function(b,c,d){!function(b,e){"function"==typeof a&&a.amd?a(e):"object"==typeof d?c.exports=e():b.SVG=e()}(this,function(){function b(a,b){b=b||{bubbles:!1,cancelable:!1,detail:void 0};var c=document.createEvent("CustomEvent");return c.initCustomEvent(a,b.bubbles,b.cancelable,b.detail),c}function c(a){return a.toLowerCase().replace(/-(.)/g,function(a,b){return b.toUpperCase()})}function e(a){return 4==a.length?["#",a.substring(1,2),a.substring(1,2),a.substring(2,3),a.substring(2,3),a.substring(3,4),a.substring(3,4)].join(""):a}function f(a){var b=a.toString(16);return 1==b.length?"0"+b:b}function g(a,b,c){return(null==b||null==c)&&(null==c?c=a.height/a.width*b:null==b&&(b=a.width/a.height*c)),{width:b,height:c}}function h(a,b){return"number"==typeof a.from?a.from+(a.to-a.from)*b:a instanceof m.Color||a instanceof m.Number?a.at(b):1>b?a.from:a.to}function i(a){for(var b=0,c=a.length,d="";c>b;b++)d+=a[b][0],null!=a[b][1]&&(d+=a[b][1],null!=a[b][2]&&(d+=" ",d+=a[b][2],null!=a[b][3]&&(d+=" ",d+=a[b][3],d+=" ",d+=a[b][4],null!=a[b][5]&&(d+=" ",d+=a[b][5],d+=" ",d+=a[b][6],null!=a[b][7]&&(d+=" ",d+=a[b][7])))));return d+" "}function j(a){a.x2=a.x+a.width,a.y2=a.y+a.height,a.cx=a.x+a.width/2,a.cy=a.y+a.height/2}function k(a){if(a.matrix){var b=a.matrix.replace(/\s/g,"").split(",");6==b.length&&(a.a=parseFloat(b[0]),a.b=parseFloat(b[1]),a.c=parseFloat(b[2]),a.d=parseFloat(b[3]),a.e=parseFloat(b[4]),a.f=parseFloat(b[5]))}return a}function l(a){var b=a.toString().match(m.regex.reference);return b?b[1]:void 0}var m=this.SVG=function(a){return m.supported?(a=new m.Doc(a),m.parser||m.prepare(a),a):void 0};if(m.ns="http://www.w3.org/2000/svg",m.xmlns="http://www.w3.org/2000/xmlns/",m.xlink="http://www.w3.org/1999/xlink",m.did=1e3,m.eid=function(a){return"Svgjs"+a.charAt(0).toUpperCase()+a.slice(1)+m.did++},m.create=function(a){var b=document.createElementNS(this.ns,a);return b.setAttribute("id",this.eid(a)),b},m.extend=function(){var a,b,c,d;for(a=[].slice.call(arguments),b=a.pop(),d=a.length-1;d>=0;d--)if(a[d])for(c in b)a[d].prototype[c]=b[c];m.Set&&m.Set.inherit&&m.Set.inherit()},m.prepare=function(a){var b=document.getElementsByTagName("body")[0],c=(b?new m.Doc(b):a.nested()).size(2,0),d=m.create("path");c.node.appendChild(d),m.parser={body:b||a.parent,draw:c.style("opacity:0;position:fixed;left:100%;top:100%;overflow:hidden"),poly:c.polyline().node,path:d}},m.supported=function(){return!!document.createElementNS&&!!document.createElementNS(m.ns,"svg").createSVGRect}(),!m.supported)return!1;m.get=function(a){var b=document.getElementById(l(a)||a);return b?b.instance:void 0},m.invent=function(a){var b="function"==typeof a.create?a.create:function(){this.constructor.call(this,m.create(a.create))};return a.inherit&&(b.prototype=new a.inherit),a.extend&&m.extend(b,a.extend),a.construct&&m.extend(a.parent||m.Container,a.construct),b},"function"!=typeof b&&(b.prototype=window.Event.prototype,window.CustomEvent=b),m.regex={unit:/^(-?[\d\.]+)([a-z%]{0,2})$/,hex:/^#?([a-f\d]{2})([a-f\d]{2})([a-f\d]{2})$/i,rgb:/rgb\((\d+),(\d+),(\d+)\)/,reference:/#([a-z0-9\-_]+)/i,isHex:/^#[a-f0-9]{3,6}$/i,isRgb:/^rgb\(/,isCss:/[^:]+:[^;]+;?/,isBlank:/^(\s+)?$/,isNumber:/^-?[\d\.]+$/,isPercent:/^-?[\d\.]+%$/,isImage:/\.(jpg|jpeg|png|gif)(\?[^=]+.*)?/i,isEvent:/^[\w]+:[\w]+$/},m.defaults={matrix:"1 0 0 1 0 0",attrs:{"fill-opacity":1,"stroke-opacity":1,"stroke-width":0,"stroke-linejoin":"miter","stroke-linecap":"butt",fill:"#000000",stroke:"#000000",opacity:1,x:0,y:0,cx:0,cy:0,width:0,height:0,r:0,rx:0,ry:0,offset:0,"stop-opacity":1,"stop-color":"#000000","font-size":16,"font-family":"Helvetica, Arial, sans-serif","text-anchor":"start"},trans:function(){return{x:0,y:0,scaleX:1,scaleY:1,rotation:0,skewX:0,skewY:0,matrix:this.matrix,a:1,b:0,c:0,d:1,e:0,f:0}}},m.Color=function(a){var b;this.r=0,this.g=0,this.b=0,"string"==typeof a?m.regex.isRgb.test(a)?(b=m.regex.rgb.exec(a.replace(/\s/g,"")),this.r=parseInt(b[1]),this.g=parseInt(b[2]),this.b=parseInt(b[3])):m.regex.isHex.test(a)&&(b=m.regex.hex.exec(e(a)),this.r=parseInt(b[1],16),this.g=parseInt(b[2],16),this.b=parseInt(b[3],16)):"object"==typeof a&&(this.r=a.r,this.g=a.g,this.b=a.b)},m.extend(m.Color,{toString:function(){return this.toHex()},toHex:function(){return"#"+f(this.r)+f(this.g)+f(this.b)},toRgb:function(){return"rgb("+[this.r,this.g,this.b].join()+")"},brightness:function(){return this.r/255*.3+this.g/255*.59+this.b/255*.11},morph:function(a){return this.destination=new m.Color(a),this},at:function(a){return this.destination?(a=0>a?0:a>1?1:a,new m.Color({r:~~(this.r+(this.destination.r-this.r)*a),g:~~(this.g+(this.destination.g-this.g)*a),b:~~(this.b+(this.destination.b-this.b)*a)})):this}}),m.Color.test=function(a){return a+="",m.regex.isHex.test(a)||m.regex.isRgb.test(a)},m.Color.isRgb=function(a){return a&&"number"==typeof a.r&&"number"==typeof a.g&&"number"==typeof a.b},m.Color.isColor=function(a){return m.Color.isRgb(a)||m.Color.test(a)},m.Array=function(a,b){a=(a||[]).valueOf(),0==a.length&&b&&(a=b.valueOf()),this.value=this.parse(a)},m.extend(m.Array,{morph:function(a){if(this.destination=this.parse(a),this.value.length!=this.destination.length){for(var b=this.value[this.value.length-1],c=this.destination[this.destination.length-1];this.value.length>this.destination.length;)this.destination.push(c);for(;this.value.length<this.destination.length;)this.value.push(b)}return this},settle:function(){for(var a=0,b=this.value.length,c=[];b>a;a++)-1==c.indexOf(this.value[a])&&c.push(this.value[a]);return this.value=c},at:function(a){if(!this.destination)return this;for(var b=0,c=this.value.length,d=[];c>b;b++)d.push(this.value[b]+(this.destination[b]-this.value[b])*a);return new m.Array(d)},toString:function(){return this.value.join(" ")},valueOf:function(){return this.value},parse:function(a){return a=a.valueOf(),Array.isArray(a)?a:this.split(a)},split:function(a){return a.replace(/\s+/g," ").replace(/^\s+|\s+$/g,"").split(" ")},reverse:function(){return this.value.reverse(),this}}),m.PointArray=function(){this.constructor.apply(this,arguments)},m.PointArray.prototype=new m.Array,m.extend(m.PointArray,{toString:function(){for(var a=0,b=this.value.length,c=[];b>a;a++)c.push(this.value[a].join(","));return c.join(" ")},at:function(a){if(!this.destination)return this;for(var b=0,c=this.value.length,d=[];c>b;b++)d.push([this.value[b][0]+(this.destination[b][0]-this.value[b][0])*a,this.value[b][1]+(this.destination[b][1]-this.value[b][1])*a]);return new m.PointArray(d)},parse:function(a){if(a=a.valueOf(),Array.isArray(a))return a;a=this.split(a);for(var b,c=0,d=a.length,e=[];d>c;c++)b=a[c].split(","),e.push([parseFloat(b[0]),parseFloat(b[1])]);return e},move:function(a,b){var c=this.bbox();if(a-=c.x,b-=c.y,!isNaN(a)&&!isNaN(b))for(var d=this.value.length-1;d>=0;d--)this.value[d]=[this.value[d][0]+a,this.value[d][1]+b];return this},size:function(a,b){var c,d=this.bbox();for(c=this.value.length-1;c>=0;c--)this.value[c][0]=(this.value[c][0]-d.x)*a/d.width+d.x,this.value[c][1]=(this.value[c][1]-d.y)*b/d.height+d.y;return this},bbox:function(){return m.parser.poly.setAttribute("points",this.toString()),m.parser.poly.getBBox()}}),m.PathArray=function(a,b){this.constructor.call(this,a,b)},m.PathArray.prototype=new m.Array,m.extend(m.PathArray,{toString:function(){return i(this.value)},move:function(a,b){var c=this.bbox();if(a-=c.x,b-=c.y,!isNaN(a)&&!isNaN(b))for(var d,e=this.value.length-1;e>=0;e--)d=this.value[e][0],"M"==d||"L"==d||"T"==d?(this.value[e][1]+=a,this.value[e][2]+=b):"H"==d?this.value[e][1]+=a:"V"==d?this.value[e][1]+=b:"C"==d||"S"==d||"Q"==d?(this.value[e][1]+=a,this.value[e][2]+=b,this.value[e][3]+=a,this.value[e][4]+=b,"C"==d&&(this.value[e][5]+=a,this.value[e][6]+=b)):"A"==d&&(this.value[e][6]+=a,this.value[e][7]+=b);return this},size:function(a,b){var c,d,e=this.bbox();for(c=this.value.length-1;c>=0;c--)d=this.value[c][0],"M"==d||"L"==d||"T"==d?(this.value[c][1]=(this.value[c][1]-e.x)*a/e.width+e.x,this.value[c][2]=(this.value[c][2]-e.y)*b/e.height+e.y):"H"==d?this.value[c][1]=(this.value[c][1]-e.x)*a/e.width+e.x:"V"==d?this.value[c][1]=(this.value[c][1]-e.y)*b/e.height+e.y:"C"==d||"S"==d||"Q"==d?(this.value[c][1]=(this.value[c][1]-e.x)*a/e.width+e.x,this.value[c][2]=(this.value[c][2]-e.y)*b/e.height+e.y,this.value[c][3]=(this.value[c][3]-e.x)*a/e.width+e.x,this.value[c][4]=(this.value[c][4]-e.y)*b/e.height+e.y,"C"==d&&(this.value[c][5]=(this.value[c][5]-e.x)*a/e.width+e.x,this.value[c][6]=(this.value[c][6]-e.y)*b/e.height+e.y)):"A"==d&&(this.value[c][1]=this.value[c][1]*a/e.width,this.value[c][2]=this.value[c][2]*b/e.height,this.value[c][6]=(this.value[c][6]-e.x)*a/e.width+e.x,this.value[c][7]=(this.value[c][7]-e.y)*b/e.height+e.y);return this},parse:function(a){if(a instanceof m.PathArray)return a.valueOf();var b,c,d,e,f,g,h,j,k,l,n,o=0,p=0;for(m.parser.path.setAttribute("d","string"==typeof a?a:i(a)),n=m.parser.path.pathSegList,b=0,c=n.numberOfItems;c>b;++b)l=n.getItem(b),k=l.pathSegTypeAsLetter,"M"==k||"L"==k||"H"==k||"V"==k||"C"==k||"S"==k||"Q"==k||"T"==k||"A"==k?("x"in l&&(o=l.x),"y"in l&&(p=l.y)):("x1"in l&&(f=o+l.x1),"x2"in l&&(h=o+l.x2),"y1"in l&&(g=p+l.y1),"y2"in l&&(j=p+l.y2),"x"in l&&(o+=l.x),"y"in l&&(p+=l.y),"m"==k?n.replaceItem(m.parser.path.createSVGPathSegMovetoAbs(o,p),b):"l"==k?n.replaceItem(m.parser.path.createSVGPathSegLinetoAbs(o,p),b):"h"==k?n.replaceItem(m.parser.path.createSVGPathSegLinetoHorizontalAbs(o),b):"v"==k?n.replaceItem(m.parser.path.createSVGPathSegLinetoVerticalAbs(p),b):"c"==k?n.replaceItem(m.parser.path.createSVGPathSegCurvetoCubicAbs(o,p,f,g,h,j),b):"s"==k?n.replaceItem(m.parser.path.createSVGPathSegCurvetoCubicSmoothAbs(o,p,h,j),b):"q"==k?n.replaceItem(m.parser.path.createSVGPathSegCurvetoQuadraticAbs(o,p,f,g),b):"t"==k?n.replaceItem(m.parser.path.createSVGPathSegCurvetoQuadraticSmoothAbs(o,p),b):"a"==k?n.replaceItem(m.parser.path.createSVGPathSegArcAbs(o,p,l.r1,l.r2,l.angle,l.largeArcFlag,l.sweepFlag),b):("z"==k||"Z"==k)&&(o=d,p=e)),("M"==k||"m"==k)&&(d=o,e=p);for(a=[],n=m.parser.path.pathSegList,b=0,c=n.numberOfItems;c>b;++b)l=n.getItem(b),k=l.pathSegTypeAsLetter,o=[k],"M"==k||"L"==k||"T"==k?o.push(l.x,l.y):"H"==k?o.push(l.x):"V"==k?o.push(l.y):"C"==k?o.push(l.x1,l.y1,l.x2,l.y2,l.x,l.y):"S"==k?o.push(l.x2,l.y2,l.x,l.y):"Q"==k?o.push(l.x1,l.y1,l.x,l.y):"A"==k&&o.push(l.r1,l.r2,l.angle,0|l.largeArcFlag,0|l.sweepFlag,l.x,l.y),a.push(o);return a},bbox:function(){return m.parser.path.setAttribute("d",this.toString()),m.parser.path.getBBox()}}),m.Number=function(a){if(this.value=0,this.unit="","number"==typeof a)this.value=isNaN(a)?0:isFinite(a)?a:0>a?-3.4e38:3.4e38;else if("string"==typeof a){var b=a.match(m.regex.unit);b&&(this.value=parseFloat(b[1]),"%"==b[2]?this.value/=100:"s"==b[2]&&(this.value*=1e3),this.unit=b[2])}else a instanceof m.Number&&(this.value=a.value,this.unit=a.unit)},m.extend(m.Number,{toString:function(){return("%"==this.unit?~~(1e8*this.value)/1e6:"s"==this.unit?this.value/1e3:this.value)+this.unit},valueOf:function(){return this.value},plus:function(a){return this.value=this+new m.Number(a),this},minus:function(a){return this.plus(-new m.Number(a))},times:function(a){return this.value=this*new m.Number(a),this},divide:function(a){return this.value=this/new m.Number(a),this},to:function(a){return"string"==typeof a&&(this.unit=a),this},morph:function(a){return this.destination=new m.Number(a),this},at:function(a){return this.destination?new m.Number(this.destination).minus(this).times(a).plus(this):this}}),m.ViewBox=function(a){var b,c,d,e,f=1,g=1,h=a.bbox(),i=(a.attr("viewBox")||"").match(/-?[\d\.]+/g),j=a,k=a;for(d=new m.Number(a.width()),e=new m.Number(a.height());"%"==d.unit;)f*=d.value,d=new m.Number(j instanceof m.Doc?j.parent.offsetWidth:j.parent.width()),j=j.parent;for(;"%"==e.unit;)g*=e.value,e=new m.Number(k instanceof m.Doc?k.parent.offsetHeight:k.parent.height()),k=k.parent;this.x=h.x,this.y=h.y,this.width=d*f,this.height=e*g,this.zoom=1,i&&(b=parseFloat(i[0]),c=parseFloat(i[1]),d=parseFloat(i[2]),e=parseFloat(i[3]),this.zoom=this.width/this.height>d/e?this.height/e:this.width/d,this.x=b,this.y=c,this.width=d,this.height=e)},m.extend(m.ViewBox,{toString:function(){return this.x+" "+this.y+" "+this.width+" "+this.height}}),m.BBox=function(a){var b;if(this.x=0,this.y=0,this.width=0,this.height=0,a){try{b=a.node.getBBox()}catch(c){b={x:a.node.clientLeft,y:a.node.clientTop,width:a.node.clientWidth,height:a.node.clientHeight}}this.x=b.x+a.trans.x,this.y=b.y+a.trans.y,this.width=b.width*a.trans.scaleX,this.height=b.height*a.trans.scaleY}j(this)},m.extend(m.BBox,{merge:function(a){var b=new m.BBox;return b.x=Math.min(this.x,a.x),b.y=Math.min(this.y,a.y),b.width=Math.max(this.x+this.width,a.x+a.width)-b.x,b.height=Math.max(this.y+this.height,a.y+a.height)-b.y,j(b),b}}),m.RBox=function(a){var b,c,d={};if(this.x=0,this.y=0,this.width=0,this.height=0,a){for(b=a.doc().parent,c=a.doc().viewbox().zoom,d=a.node.getBoundingClientRect(),this.x=d.left,this.y=d.top,this.x-=b.offsetLeft,this.y-=b.offsetTop;b=b.offsetParent;)this.x-=b.offsetLeft,this.y-=b.offsetTop;for(b=a;b=b.parent;)"svg"==b.type&&b.viewbox&&(c*=b.viewbox().zoom,this.x-=b.x()||0,this.y-=b.y()||0)}this.x/=c,this.y/=c,this.width=d.width/=c,this.height=d.height/=c,this.x+="number"==typeof window.scrollX?window.scrollX:window.pageXOffset,this.y+="number"==typeof window.scrollY?window.scrollY:window.pageYOffset,j(this)},m.extend(m.RBox,{merge:function(a){var b=new m.RBox;return b.x=Math.min(this.x,a.x),b.y=Math.min(this.y,a.y),b.width=Math.max(this.x+this.width,a.x+a.width)-b.x,b.height=Math.max(this.y+this.height,a.y+a.height)-b.y,j(b),b}}),m.Element=m.invent({create:function(a){this._stroke=m.defaults.attrs.stroke,this.trans=m.defaults.trans(),(this.node=a)&&(this.type=a.nodeName,this.node.instance=this)},extend:{x:function(a){return null!=a&&(a=new m.Number(a),a.value/=this.trans.scaleX),this.attr("x",a)},y:function(a){return null!=a&&(a=new m.Number(a),a.value/=this.trans.scaleY),this.attr("y",a)},cx:function(a){return null==a?this.x()+this.width()/2:this.x(a-this.width()/2)},cy:function(a){return null==a?this.y()+this.height()/2:this.y(a-this.height()/2)},move:function(a,b){return this.x(a).y(b)},center:function(a,b){return this.cx(a).cy(b)},width:function(a){return this.attr("width",a)},height:function(a){return this.attr("height",a)},size:function(a,b){var c=g(this.bbox(),a,b);return this.width(new m.Number(c.width)).height(new m.Number(c.height))},clone:function(){var a,b,c=this.type;return a="rect"==c||"ellipse"==c?this.parent[c](0,0):"line"==c?this.parent[c](0,0,0,0):"image"==c?this.parent[c](this.src):"text"==c?this.parent[c](this.content):"path"==c?this.parent[c](this.attr("d")):"polyline"==c||"polygon"==c?this.parent[c](this.attr("points")):"g"==c?this.parent.group():this.parent[c](),b=this.attr(),delete b.id,a.attr(b),a.trans=this.trans,a.transform({})},remove:function(){return this.parent&&this.parent.removeElement(this),this},replace:function(a){return this.after(a).remove(),a},addTo:function(a){return a.put(this)},putIn:function(a){return a.add(this)},doc:function(a){return this._parent(a||m.Doc)},attr:function(a,b,c){if(null==a){for(a={},b=this.node.attributes,c=b.length-1;c>=0;c--)a[b[c].nodeName]=m.regex.isNumber.test(b[c].nodeValue)?parseFloat(b[c].nodeValue):b[c].nodeValue;return a}if("object"==typeof a)for(b in a)this.attr(b,a[b]);else if(null===b)this.node.removeAttribute(a);else{
if(null==b)return b=this.node.attributes[a],null==b?m.defaults.attrs[a]:m.regex.isNumber.test(b.nodeValue)?parseFloat(b.nodeValue):b.nodeValue;if("style"==a)return this.style(b);"stroke-width"==a?this.attr("stroke",parseFloat(b)>0?this._stroke:null):"stroke"==a&&(this._stroke=b),("fill"==a||"stroke"==a)&&(m.regex.isImage.test(b)&&(b=this.doc().defs().image(b,0,0)),b instanceof m.Image&&(b=this.doc().defs().pattern(0,0,function(){this.add(b)}))),"number"==typeof b?b=new m.Number(b):m.Color.isColor(b)?b=new m.Color(b):Array.isArray(b)&&(b=new m.Array(b)),"leading"==a?this.leading&&this.leading(b):"string"==typeof c?this.node.setAttributeNS(c,a,b.toString()):this.node.setAttribute(a,b.toString()),!this.rebuild||"font-size"!=a&&"x"!=a||this.rebuild(a,b)}return this},transform:function(a,b){if(0==arguments.length)return this.trans;if("string"==typeof a){if(arguments.length<2)return this.trans[a];var c={};return c[a]=b,this.transform(c)}var c=[];a=k(a);for(b in a)null!=a[b]&&(this.trans[b]=a[b]);return this.trans.matrix=this.trans.a+" "+this.trans.b+" "+this.trans.c+" "+this.trans.d+" "+this.trans.e+" "+this.trans.f,a=this.trans,a.matrix!=m.defaults.matrix&&c.push("matrix("+a.matrix+")"),0!=a.rotation&&c.push("rotate("+a.rotation+" "+(null==a.cx?this.bbox().cx:a.cx)+" "+(null==a.cy?this.bbox().cy:a.cy)+")"),(1!=a.scaleX||1!=a.scaleY)&&c.push("scale("+a.scaleX+" "+a.scaleY+")"),0!=a.skewX&&c.push("skewX("+a.skewX+")"),0!=a.skewY&&c.push("skewY("+a.skewY+")"),(0!=a.x||0!=a.y)&&c.push("translate("+new m.Number(a.x/a.scaleX)+" "+new m.Number(a.y/a.scaleY)+")"),0==c.length?this.node.removeAttribute("transform"):this.node.setAttribute("transform",c.join(" ")),this},style:function(a,b){if(0==arguments.length)return this.node.style.cssText||"";if(arguments.length<2)if("object"==typeof a)for(b in a)this.style(b,a[b]);else{if(!m.regex.isCss.test(a))return this.node.style[c(a)];a=a.split(";");for(var d=0;d<a.length;d++)b=a[d].split(":"),this.style(b[0].replace(/\s+/g,""),b[1])}else this.node.style[c(a)]=null===b||m.regex.isBlank.test(b)?"":b;return this},id:function(a){return this.attr("id",a)},bbox:function(){return new m.BBox(this)},rbox:function(){return new m.RBox(this)},inside:function(a,b){var c=this.bbox();return a>c.x&&b>c.y&&a<c.x+c.width&&b<c.y+c.height},show:function(){return this.style("display","")},hide:function(){return this.style("display","none")},visible:function(){return"none"!=this.style("display")},toString:function(){return this.attr("id")},classes:function(){var a=this.node.getAttribute("class");return null===a?[]:a.trim().split(/\s+/)},hasClass:function(a){return-1!=this.classes().indexOf(a)},addClass:function(a){var b;return this.hasClass(a)||(b=this.classes(),b.push(a),this.node.setAttribute("class",b.join(" "))),this},removeClass:function(a){var b;return this.hasClass(a)&&(b=this.classes().filter(function(b){return b!=a}),this.node.setAttribute("class",b.join(" "))),this},toggleClass:function(a){return this.hasClass(a)?this.removeClass(a):this.addClass(a),this},reference:function(a){return m.get(this.attr()[a])},_parent:function(a){for(var b=this;null!=b&&!(b instanceof a);)b=b.parent;return b}}}),m.Parent=m.invent({create:function(a){this.constructor.call(this,a)},inherit:m.Element,extend:{children:function(){return this._children||(this._children=[])},add:function(a,b){return this.has(a)||(b=null==b?this.children().length:b,a.parent&&a.parent.children().splice(a.parent.index(a),1),this.children().splice(b,0,a),this.node.insertBefore(a.node,this.node.childNodes[b]||null),a.parent=this),this._defs&&(this.node.removeChild(this._defs.node),this.node.appendChild(this._defs.node)),this},put:function(a,b){return this.add(a,b),a},has:function(a){return this.index(a)>=0},index:function(a){return this.children().indexOf(a)},get:function(a){return this.children()[a]},first:function(){return this.children()[0]},last:function(){return this.children()[this.children().length-1]},each:function(a,b){var c,d,e=this.children();for(c=0,d=e.length;d>c;c++)e[c]instanceof m.Element&&a.apply(e[c],[c,e]),b&&e[c]instanceof m.Container&&e[c].each(a,b);return this},removeElement:function(a){return this.children().splice(this.index(a),1),this.node.removeChild(a.node),a.parent=null,this},clear:function(){for(var a=this.children().length-1;a>=0;a--)this.removeElement(this.children()[a]);return this._defs&&this._defs.clear(),this},defs:function(){return this.doc().defs()}}}),m.Container=m.invent({create:function(a){this.constructor.call(this,a)},inherit:m.Parent,extend:{viewbox:function(a){return 0==arguments.length?new m.ViewBox(this):(a=1==arguments.length?[a.x,a.y,a.width,a.height]:[].slice.call(arguments),this.attr("viewBox",a))}}}),m.FX=m.invent({create:function(a){this.target=a},extend:{animate:function(a,b,c){var d,e,f,g,i=this.target,j=this;return"object"==typeof a&&(c=a.delay,b=a.ease,a=a.duration),a="="==a?a:null==a?1e3:new m.Number(a).valueOf(),b=b||"<>",j.to=function(a){var c;if(a=0>a?0:a>1?1:a,null==d){d=[];for(g in j.attrs)d.push(g);if(i.morphArray&&(j._plot||d.indexOf("points")>-1)){var k,l=new i.morphArray(j._plot||j.attrs.points||i.array);j._size&&l.size(j._size.width.to,j._size.height.to),k=l.bbox(),j._x?l.move(j._x.to,k.y):j._cx&&l.move(j._cx.to-k.width/2,k.y),k=l.bbox(),j._y?l.move(k.x,j._y.to):j._cy&&l.move(k.x,j._cy.to-k.height/2),delete j._x,delete j._y,delete j._cx,delete j._cy,delete j._size,j._plot=i.array.morph(l)}}if(null==e){e=[];for(g in j.trans)e.push(g)}if(null==f){f=[];for(g in j.styles)f.push(g)}for(a="<>"==b?-Math.cos(a*Math.PI)/2+.5:">"==b?Math.sin(a*Math.PI/2):"<"==b?-Math.cos(a*Math.PI/2)+1:"-"==b?a:"function"==typeof b?b(a):a,j._plot?i.plot(j._plot.at(a)):(j._x?i.x(j._x.at(a)):j._cx&&i.cx(j._cx.at(a)),j._y?i.y(j._y.at(a)):j._cy&&i.cy(j._cy.at(a)),j._size&&i.size(j._size.width.at(a),j._size.height.at(a))),j._viewbox&&i.viewbox(j._viewbox.x.at(a),j._viewbox.y.at(a),j._viewbox.width.at(a),j._viewbox.height.at(a)),j._leading&&i.leading(j._leading.at(a)),c=d.length-1;c>=0;c--)i.attr(d[c],h(j.attrs[d[c]],a));for(c=e.length-1;c>=0;c--)i.transform(e[c],h(j.trans[e[c]],a));for(c=f.length-1;c>=0;c--)i.style(f[c],h(j.styles[f[c]],a));j._during&&j._during.call(i,a,function(b,c){return h({from:b,to:c},a)})},"number"==typeof a&&(this.timeout=setTimeout(function(){var d=(new Date).getTime();j.situation={interval:1e3/60,start:d,play:!0,finish:d+a,duration:a},j.render=function(){if(j.situation.play===!0){var d=(new Date).getTime(),e=d>j.situation.finish?1:(d-j.situation.start)/a;j.to(e),d>j.situation.finish?(j._plot&&i.plot(new m.PointArray(j._plot.destination).settle()),j._loop===!0||"number"==typeof j._loop&&j._loop>1?("number"==typeof j._loop&&--j._loop,j.animate(a,b,c)):j._after?j._after.apply(i,[j]):j.stop()):requestAnimFrame(j.render)}else requestAnimFrame(j.render)},j.render()},new m.Number(c).valueOf())),this},bbox:function(){return this.target.bbox()},attr:function(a,b){if("object"==typeof a)for(var c in a)this.attr(c,a[c]);else{var d=this.target.attr(a);this.attrs[a]=m.Color.isColor(d)?new m.Color(d).morph(b):m.regex.unit.test(d)?new m.Number(d).morph(b):{from:d,to:b}}return this},transform:function(a,b){if(1==arguments.length){a=k(a),delete a.matrix;for(b in a)this.trans[b]={from:this.target.trans[b],to:a[b]}}else{var c={};c[a]=b,this.transform(c)}return this},style:function(a,b){if("object"==typeof a)for(var c in a)this.style(c,a[c]);else this.styles[a]={from:this.target.style(a),to:b};return this},x:function(a){return this._x=new m.Number(this.target.x()).morph(a),this},y:function(a){return this._y=new m.Number(this.target.y()).morph(a),this},cx:function(a){return this._cx=new m.Number(this.target.cx()).morph(a),this},cy:function(a){return this._cy=new m.Number(this.target.cy()).morph(a),this},move:function(a,b){return this.x(a).y(b)},center:function(a,b){return this.cx(a).cy(b)},size:function(a,b){if(this.target instanceof m.Text)this.attr("font-size",a);else{var c=this.target.bbox();this._size={width:new m.Number(c.width).morph(a),height:new m.Number(c.height).morph(b)}}return this},plot:function(a){return this._plot=a,this},leading:function(a){return this.target._leading&&(this._leading=new m.Number(this.target._leading).morph(a)),this},viewbox:function(a,b,c,d){if(this.target instanceof m.Container){var e=this.target.viewbox();this._viewbox={x:new m.Number(e.x).morph(a),y:new m.Number(e.y).morph(b),width:new m.Number(e.width).morph(c),height:new m.Number(e.height).morph(d)}}return this},update:function(a){return this.target instanceof m.Stop&&(null!=a.opacity&&this.attr("stop-opacity",a.opacity),null!=a.color&&this.attr("stop-color",a.color),null!=a.offset&&this.attr("offset",new m.Number(a.offset))),this},during:function(a){return this._during=a,this},after:function(a){return this._after=a,this},loop:function(a){return this._loop=a||!0,this},stop:function(a){return a===!0?(this.animate(0),this._after&&this._after.apply(this.target,[this])):(clearTimeout(this.timeout),this.attrs={},this.trans={},this.styles={},this.situation={},delete this._x,delete this._y,delete this._cx,delete this._cy,delete this._size,delete this._plot,delete this._loop,delete this._after,delete this._during,delete this._leading,delete this._viewbox),this},pause:function(){return this.situation.play===!0&&(this.situation.play=!1,this.situation.pause=(new Date).getTime()),this},play:function(){if(this.situation.play===!1){var a=(new Date).getTime()-this.situation.pause;this.situation.finish+=a,this.situation.start+=a,this.situation.play=!0}return this}},parent:m.Element,construct:{animate:function(a,b,c){return(this.fx||(this.fx=new m.FX(this))).stop().animate(a,b,c)},stop:function(a){return this.fx&&this.fx.stop(a),this},pause:function(){return this.fx&&this.fx.pause(),this},play:function(){return this.fx&&this.fx.play(),this}}}),m.extend(m.Element,m.FX,{dx:function(a){return this.x((this.target||this).x()+a)},dy:function(a){return this.y((this.target||this).y()+a)},dmove:function(a,b){return this.dx(a).dy(b)}}),["click","dblclick","mousedown","mouseup","mouseover","mouseout","mousemove","touchstart","touchmove","touchleave","touchend","touchcancel"].forEach(function(a){m.Element.prototype[a]=function(b){var c=this;return this.node["on"+a]="function"==typeof b?function(){return b.apply(c,arguments)}:null,this}}),m.events={},m.listeners={},m.registerEvent=function(a){m.events[a]||(m.events[a]=new b(a))},m.on=function(a,b,c){var d=c.bind(a.instance||a);m.listeners[a]=m.listeners[a]||{},m.listeners[a][b]=m.listeners[a][b]||{},m.listeners[a][b][c]=d,a.addEventListener(b,d,!1)},m.off=function(a,b,c){if(c)m.listeners[a]&&m.listeners[a][b]&&(a.removeEventListener(b,m.listeners[a][b][c],!1),delete m.listeners[a][b][c]);else if(b){if(m.listeners[a][b]){for(c in m.listeners[a][b])m.off(a,b,c);delete m.listeners[a][b]}}else if(m.listeners[a]){for(b in m.listeners[a])m.off(a,b);delete m.listeners[a]}},m.extend(m.Element,{on:function(a,b){return m.on(this.node,a,b),this},off:function(a,b){return m.off(this.node,a,b),this},fire:function(a,b){return m.events[a].detail=b,this.node.dispatchEvent(m.events[a]),delete m.events[a].detail,this}}),m.Defs=m.invent({create:"defs",inherit:m.Container}),m.G=m.invent({create:"g",inherit:m.Container,extend:{x:function(a){return null==a?this.trans.x:this.transform("x",a)},y:function(a){return null==a?this.trans.y:this.transform("y",a)},cx:function(a){return null==a?this.bbox().cx:this.x(a-this.bbox().width/2)},cy:function(a){return null==a?this.bbox().cy:this.y(a-this.bbox().height/2)}},construct:{group:function(){return this.put(new m.G)}}}),m.extend(m.Element,{siblings:function(){return this.parent.children()},position:function(){return this.parent.index(this)},next:function(){return this.siblings()[this.position()+1]},previous:function(){return this.siblings()[this.position()-1]},forward:function(){var a=this.position();return this.parent.removeElement(this).put(this,a+1)},backward:function(){var a=this.position();return a>0&&this.parent.removeElement(this).add(this,a-1),this},front:function(){return this.parent.removeElement(this).put(this)},back:function(){return this.position()>0&&this.parent.removeElement(this).add(this,0),this},before:function(a){a.remove();var b=this.position();return this.parent.add(a,b),this},after:function(a){a.remove();var b=this.position();return this.parent.add(a,b+1),this}}),m.Mask=m.invent({create:function(){this.constructor.call(this,m.create("mask")),this.targets=[]},inherit:m.Container,extend:{remove:function(){for(var a=this.targets.length-1;a>=0;a--)this.targets[a]&&this.targets[a].unmask();return delete this.targets,this.parent.removeElement(this),this}},construct:{mask:function(){return this.defs().put(new m.Mask)}}}),m.extend(m.Element,{maskWith:function(a){return this.masker=a instanceof m.Mask?a:this.parent.mask().add(a),this.masker.targets.push(this),this.attr("mask",'url("#'+this.masker.attr("id")+'")')},unmask:function(){return delete this.masker,this.attr("mask",null)}}),m.Clip=m.invent({create:function(){this.constructor.call(this,m.create("clipPath")),this.targets=[]},inherit:m.Container,extend:{remove:function(){for(var a=this.targets.length-1;a>=0;a--)this.targets[a]&&this.targets[a].unclip();return delete this.targets,this.parent.removeElement(this),this}},construct:{clip:function(){return this.defs().put(new m.Clip)}}}),m.extend(m.Element,{clipWith:function(a){return this.clipper=a instanceof m.Clip?a:this.parent.clip().add(a),this.clipper.targets.push(this),this.attr("clip-path",'url("#'+this.clipper.attr("id")+'")')},unclip:function(){return delete this.clipper,this.attr("clip-path",null)}}),m.Gradient=m.invent({create:function(a){this.constructor.call(this,m.create(a+"Gradient")),this.type=a},inherit:m.Container,extend:{from:function(a,b){return"radial"==this.type?this.attr({fx:new m.Number(a),fy:new m.Number(b)}):this.attr({x1:new m.Number(a),y1:new m.Number(b)})},to:function(a,b){return"radial"==this.type?this.attr({cx:new m.Number(a),cy:new m.Number(b)}):this.attr({x2:new m.Number(a),y2:new m.Number(b)})},radius:function(a){return"radial"==this.type?this.attr({r:new m.Number(a)}):this},at:function(a,b,c){return this.put(new m.Stop).update(a,b,c)},update:function(a){return this.clear(),"function"==typeof a&&a.call(this,this),this},fill:function(){return"url(#"+this.id()+")"},toString:function(){return this.fill()}},construct:{gradient:function(a,b){return this.defs().gradient(a,b)}}}),m.extend(m.Defs,{gradient:function(a,b){return this.put(new m.Gradient(a)).update(b)}}),m.Stop=m.invent({create:"stop",inherit:m.Element,extend:{update:function(a){return("number"==typeof a||a instanceof m.Number)&&(a={offset:arguments[0],color:arguments[1],opacity:arguments[2]}),null!=a.opacity&&this.attr("stop-opacity",a.opacity),null!=a.color&&this.attr("stop-color",a.color),null!=a.offset&&this.attr("offset",new m.Number(a.offset)),this}}}),m.Pattern=m.invent({create:"pattern",inherit:m.Container,extend:{fill:function(){return"url(#"+this.id()+")"},update:function(a){return this.clear(),"function"==typeof a&&a.call(this,this),this},toString:function(){return this.fill()}},construct:{pattern:function(a,b,c){return this.defs().pattern(a,b,c)}}}),m.extend(m.Defs,{pattern:function(a,b,c){return this.put(new m.Pattern).update(c).attr({x:0,y:0,width:a,height:b,patternUnits:"userSpaceOnUse"})}}),m.Doc=m.invent({create:function(a){this.parent="string"==typeof a?document.getElementById(a):a,this.constructor.call(this,"svg"==this.parent.nodeName?this.parent:m.create("svg")),this.attr({xmlns:m.ns,version:"1.1",width:"100%",height:"100%"}).attr("xmlns:xlink",m.xlink,m.xmlns),this._defs=new m.Defs,this._defs.parent=this,this.node.appendChild(this._defs.node),this.doSpof=!1,this.parent!=this.node&&this.stage()},inherit:m.Container,extend:{stage:function(){var a=this;return this.parent.appendChild(this.node),a.spof(),m.on(window,"resize",function(){a.spof()}),this},defs:function(){return this._defs},spof:function(){if(this.doSpof){var a=this.node.getScreenCTM();a&&this.style("left",-a.e%1+"px").style("top",-a.f%1+"px")}return this},fixSubPixelOffset:function(){return this.doSpof=!0,this}}}),m.Shape=m.invent({create:function(a){this.constructor.call(this,a)},inherit:m.Element}),m.Symbol=m.invent({create:"symbol",inherit:m.Container,construct:{symbol:function(){return this.defs().put(new m.Symbol)}}}),m.Use=m.invent({create:"use",inherit:m.Shape,extend:{element:function(a){return this.target=a,this.attr("href","#"+a,m.xlink)}},construct:{use:function(a){return this.put(new m.Use).element(a)}}}),m.Rect=m.invent({create:"rect",inherit:m.Shape,construct:{rect:function(a,b){return this.put((new m.Rect).size(a,b))}}}),m.Ellipse=m.invent({create:"ellipse",inherit:m.Shape,extend:{x:function(a){return null==a?this.cx()-this.attr("rx"):this.cx(a+this.attr("rx"))},y:function(a){return null==a?this.cy()-this.attr("ry"):this.cy(a+this.attr("ry"))},cx:function(a){return null==a?this.attr("cx"):this.attr("cx",new m.Number(a).divide(this.trans.scaleX))},cy:function(a){return null==a?this.attr("cy"):this.attr("cy",new m.Number(a).divide(this.trans.scaleY))},width:function(a){return null==a?2*this.attr("rx"):this.attr("rx",new m.Number(a).divide(2))},height:function(a){return null==a?2*this.attr("ry"):this.attr("ry",new m.Number(a).divide(2))},size:function(a,b){var c=g(this.bbox(),a,b);return this.attr({rx:new m.Number(c.width).divide(2),ry:new m.Number(c.height).divide(2)})}},construct:{circle:function(a){return this.ellipse(a,a)},ellipse:function(a,b){return this.put(new m.Ellipse).size(a,b).move(0,0)}}}),m.Line=m.invent({create:"line",inherit:m.Shape,extend:{x:function(a){var b=this.bbox();return null==a?b.x:this.attr({x1:this.attr("x1")-b.x+a,x2:this.attr("x2")-b.x+a})},y:function(a){var b=this.bbox();return null==a?b.y:this.attr({y1:this.attr("y1")-b.y+a,y2:this.attr("y2")-b.y+a})},cx:function(a){var b=this.bbox().width/2;return null==a?this.x()+b:this.x(a-b)},cy:function(a){var b=this.bbox().height/2;return null==a?this.y()+b:this.y(a-b)},width:function(a){var b=this.bbox();return null==a?b.width:this.attr(this.attr("x1")<this.attr("x2")?"x2":"x1",b.x+a)},height:function(a){var b=this.bbox();return null==a?b.height:this.attr(this.attr("y1")<this.attr("y2")?"y2":"y1",b.y+a)},size:function(a,b){var c=g(this.bbox(),a,b);return this.width(c.width).height(c.height)},plot:function(a,b,c,d){return this.attr({x1:a,y1:b,x2:c,y2:d})}},construct:{line:function(a,b,c,d){return this.put((new m.Line).plot(a,b,c,d))}}}),m.Polyline=m.invent({create:"polyline",inherit:m.Shape,construct:{polyline:function(a){return this.put(new m.Polyline).plot(a)}}}),m.Polygon=m.invent({create:"polygon",inherit:m.Shape,construct:{polygon:function(a){return this.put(new m.Polygon).plot(a)}}}),m.extend(m.Polyline,m.Polygon,{morphArray:m.PointArray,plot:function(a){return this.attr("points",this.array=new m.PointArray(a,[[0,0]]))},move:function(a,b){return this.attr("points",this.array.move(a,b))},x:function(a){return null==a?this.bbox().x:this.move(a,this.bbox().y)},y:function(a){return null==a?this.bbox().y:this.move(this.bbox().x,a)},width:function(a){var b=this.bbox();return null==a?b.width:this.size(a,b.height)},height:function(a){var b=this.bbox();return null==a?b.height:this.size(b.width,a)},size:function(a,b){var c=g(this.bbox(),a,b);return this.attr("points",this.array.size(c.width,c.height))}}),m.Path=m.invent({create:"path",inherit:m.Shape,extend:{plot:function(a){return this.attr("d",this.array=new m.PathArray(a,[["M",0,0]]))},move:function(a,b){return this.attr("d",this.array.move(a,b))},x:function(a){return null==a?this.bbox().x:this.move(a,this.bbox().y)},y:function(a){return null==a?this.bbox().y:this.move(this.bbox().x,a)},size:function(a,b){var c=g(this.bbox(),a,b);return this.attr("d",this.array.size(c.width,c.height))},width:function(a){return null==a?this.bbox().width:this.size(a,this.bbox().height)},height:function(a){return null==a?this.bbox().height:this.size(this.bbox().width,a)}},construct:{path:function(a){return this.put(new m.Path).plot(a)}}}),m.Image=m.invent({create:"image",inherit:m.Shape,extend:{load:function(a){if(!a)return this;var b=this,c=document.createElement("img");return c.onload=function(){var d=b.doc(m.Pattern);0==b.width()&&0==b.height()&&b.size(c.width,c.height),d&&0==d.width()&&0==d.height()&&d.size(b.width(),b.height()),"function"==typeof b._loaded&&b._loaded.call(b,{width:c.width,height:c.height,ratio:c.width/c.height,url:a})},this.attr("href",c.src=this.src=a,m.xlink)},loaded:function(a){return this._loaded=a,this}},construct:{image:function(a,b,c){return this.put(new m.Image).load(a).size(b||0,c||b||0)}}}),m.Text=m.invent({create:function(){this.constructor.call(this,m.create("text")),this._leading=new m.Number(1.3),this._rebuild=!0,this._build=!1,this.attr("font-family",m.defaults.attrs["font-family"])},inherit:m.Shape,extend:{x:function(a){return null==a?this.attr("x"):(this.textPath||this.lines.each(function(){this.newLined&&this.x(a)}),this.attr("x",a))},y:function(a){var b=this.attr("y"),c="number"==typeof b?b-this.bbox().y:0;return null==a?"number"==typeof b?b-c:b:this.attr("y","number"==typeof a?a+c:a)},cx:function(a){return null==a?this.bbox().cx:this.x(a-this.bbox().width/2)},cy:function(a){return null==a?this.bbox().cy:this.y(a-this.bbox().height/2)},text:function(a){if("undefined"==typeof a)return this.content;if(this.clear().build(!0),"function"==typeof a)a.call(this,this);else{a=(this.content=a).split("\n");for(var b=0,c=a.length;c>b;b++)this.tspan(a[b]).newLine()}return this.build(!1).rebuild()},size:function(a){return this.attr("font-size",a).rebuild()},leading:function(a){return null==a?this._leading:(this._leading=new m.Number(a),this.rebuild())},rebuild:function(a){if("boolean"==typeof a&&(this._rebuild=a),this._rebuild){var b=this;this.lines.each(function(){this.newLined&&(this.textPath||this.attr("x",b.attr("x")),this.attr("dy",b._leading*new m.Number(b.attr("font-size"))))}),this.fire("rebuild")}return this},build:function(a){return this._build=!!a,this}},construct:{text:function(a){return this.put(new m.Text).text(a)},plain:function(a){return this.put(new m.Text).plain(a)}}}),m.TSpan=m.invent({create:"tspan",inherit:m.Shape,extend:{text:function(a){return"function"==typeof a?a.call(this,this):this.plain(a),this},dx:function(a){return this.attr("dx",a)},dy:function(a){return this.attr("dy",a)},newLine:function(){var a=this.doc(m.Text);return this.newLined=!0,this.dy(a._leading*a.attr("font-size")).attr("x",a.x())}}}),m.extend(m.Text,m.TSpan,{plain:function(a){return this._build===!1&&this.clear(),this.node.appendChild(document.createTextNode(this.content=a)),this},tspan:function(a){var b=(this.textPath||this).node,c=new m.TSpan;return this._build===!1&&this.clear(),b.appendChild(c.node),c.parent=this,this instanceof m.Text&&this.lines.add(c),c.text(a)},clear:function(){for(var a=(this.textPath||this).node;a.hasChildNodes();)a.removeChild(a.lastChild);return this instanceof m.Text&&(delete this.lines,this.lines=new m.Set,this.content=""),this},length:function(){return this.node.getComputedTextLength()}}),m.registerEvent("rebuild"),m.TextPath=m.invent({create:"textPath",inherit:m.Element,parent:m.Text,construct:{path:function(a){for(this.textPath=new m.TextPath;this.node.hasChildNodes();)this.textPath.node.appendChild(this.node.firstChild);return this.node.appendChild(this.textPath.node),this.track=this.doc().defs().path(a),this.textPath.parent=this,this.textPath.attr("href","#"+this.track,m.xlink),this},plot:function(a){return this.track&&this.track.plot(a),this}}}),m.Nested=m.invent({create:function(){this.constructor.call(this,m.create("svg")),this.style("overflow","visible")},inherit:m.Container,construct:{nested:function(){return this.put(new m.Nested)}}}),m.A=m.invent({create:"a",inherit:m.Container,extend:{to:function(a){return this.attr("href",a,m.xlink)},show:function(a){return this.attr("show",a,m.xlink)},target:function(a){return this.attr("target",a)}},construct:{link:function(a){return this.put(new m.A).to(a)}}}),m.extend(m.Element,{linkTo:function(a){var b=new m.A;return"function"==typeof a?a.call(b,b):b.to(a),this.parent.put(b).put(this)}}),m.Marker=m.invent({create:"marker",inherit:m.Container,extend:{width:function(a){return this.attr("markerWidth",a)},height:function(a){return this.attr("markerHeight",a)},ref:function(a,b){return this.attr("refX",a).attr("refY",b)},update:function(a){return this.clear(),"function"==typeof a&&a.call(this,this),this},toString:function(){return"url(#"+this.id()+")"}},construct:{marker:function(a,b,c){return this.defs().marker(a,b,c)}}}),m.extend(m.Defs,{marker:function(a,b,c){return this.put(new m.Marker).size(a,b).ref(a/2,b/2).viewbox(0,0,a,b).attr("orient","auto").update(c)}}),m.extend(m.Line,m.Polyline,m.Polygon,m.Path,{marker:function(a,b,c,d){var e=["marker"];return"all"!=a&&e.push(a),e=e.join("-"),a=arguments[1]instanceof m.Marker?arguments[1]:this.doc().marker(b,c,d),this.attr(e,a)}});var n={stroke:["color","width","opacity","linecap","linejoin","miterlimit","dasharray","dashoffset"],fill:["color","opacity","rule"],prefix:function(a,b){return"color"==b?a:a+"-"+b}};return["fill","stroke"].forEach(function(a){var b,c={};c[a]=function(c){if("string"==typeof c||m.Color.isRgb(c)||c&&"function"==typeof c.fill)this.attr(a,c);else for(b=n[a].length-1;b>=0;b--)null!=c[n[a][b]]&&this.attr(n.prefix(a,n[a][b]),c[n[a][b]]);return this},m.extend(m.Element,m.FX,c)}),m.extend(m.Element,m.FX,{rotate:function(a,b,c){return this.transform({rotation:a||0,cx:b,cy:c})},skew:function(a,b){return this.transform({skewX:a||0,skewY:b||0})},scale:function(a,b){return this.transform({scaleX:a,scaleY:null==b?a:b})},translate:function(a,b){return this.transform({x:a,y:b})},matrix:function(a){return this.transform({matrix:a})},opacity:function(a){return this.attr("opacity",a)}}),m.extend(m.Rect,m.Ellipse,m.FX,{radius:function(a,b){return this.attr({rx:a,ry:b||a})}}),m.extend(m.Path,{length:function(){return this.node.getTotalLength()},pointAt:function(a){return this.node.getPointAtLength(a)}}),m.extend(m.Parent,m.Text,m.FX,{font:function(a){for(var b in a)"leading"==b?this.leading(a[b]):"anchor"==b?this.attr("text-anchor",a[b]):"size"==b||"family"==b||"weight"==b||"stretch"==b||"variant"==b||"style"==b?this.attr("font-"+b,a[b]):this.attr(b,a[b]);return this}}),m.Set=m.invent({create:function(){this.clear()},extend:{add:function(){var a,b,c=[].slice.call(arguments);for(a=0,b=c.length;b>a;a++)this.members.push(c[a]);return this},remove:function(a){var b=this.index(a);return b>-1&&this.members.splice(b,1),this},each:function(a){for(var b=0,c=this.members.length;c>b;b++)a.apply(this.members[b],[b,this.members]);return this},clear:function(){return this.members=[],this},has:function(a){return this.index(a)>=0},index:function(a){return this.members.indexOf(a)},get:function(a){return this.members[a]},first:function(){return this.get(0)},last:function(){return this.get(this.members.length-1)},valueOf:function(){return this.members},bbox:function(){var a=new m.BBox;if(0==this.members.length)return a;var b=this.members[0].rbox();return a.x=b.x,a.y=b.y,a.width=b.width,a.height=b.height,this.each(function(){a=a.merge(this.rbox())}),a}},construct:{set:function(){return new m.Set}}}),m.SetFX=m.invent({create:function(a){this.set=a}}),m.Set.inherit=function(){var a,b=[];for(var a in m.Shape.prototype)"function"==typeof m.Shape.prototype[a]&&"function"!=typeof m.Set.prototype[a]&&b.push(a);b.forEach(function(a){m.Set.prototype[a]=function(){for(var b=0,c=this.members.length;c>b;b++)this.members[b]&&"function"==typeof this.members[b][a]&&this.members[b][a].apply(this.members[b],arguments);return"animate"==a?this.fx||(this.fx=new m.SetFX(this)):this}}),b=[];for(var a in m.FX.prototype)"function"==typeof m.FX.prototype[a]&&"function"!=typeof m.SetFX.prototype[a]&&b.push(a);b.forEach(function(a){m.SetFX.prototype[a]=function(){for(var b=0,c=this.set.members.length;c>b;b++)this.set.members[b].fx[a].apply(this.set.members[b].fx,arguments);return this}})},m.extend(m.Element,{data:function(a,b,c){if("object"==typeof a)for(b in a)this.data(b,a[b]);else if(arguments.length<2)try{return JSON.parse(this.attr("data-"+a))}catch(d){return this.attr("data-"+a)}else this.attr("data-"+a,null===b?null:c===!0||"string"==typeof b||"number"==typeof b?b:JSON.stringify(b));return this}}),m.extend(m.Element,{remember:function(a,b){if("object"==typeof arguments[0])for(var b in a)this.remember(b,a[b]);else{if(1==arguments.length)return this.memory()[a];this.memory()[a]=b}return this},forget:function(){if(0==arguments.length)this._memory={};else for(var a=arguments.length-1;a>=0;a--)delete this.memory()[arguments[a]];return this},memory:function(){return this._memory||(this._memory={})}}),"function"==typeof a&&a.amd?a(function(){return m}):"undefined"!=typeof d&&(d.SVG=m),window.requestAnimFrame=function(){return window.requestAnimationFrame||window.webkitRequestAnimationFrame||window.mozRequestAnimationFrame||window.msRequestAnimationFrame||function(a){window.setTimeout(a,1e3/60)}}(),m})},{}]},{},[2])(2)});